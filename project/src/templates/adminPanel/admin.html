<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lux Bank</title>
    <link rel="stylesheet" href="reset.css" />
    <link rel="stylesheet" href="home.css" />
    <link rel="stylesheet" href="main.css" />
    <link rel="stylesheet" href="usercartsec.css" />
    <script src="/bootstrap.bundle.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        font-family: monospace;
      }

      table {
        border-collapse: collapse;
      }

      th {
        font-size: 20px;
        font-weight: 700;
      }

      th,
      td {
        border: 1px solid black;
        padding: 8px;
      }

      .noVisible {
        display: none;
      }

      .userFormND {
        display: none;
      }

      .userFormYD {
        display: block;
      }

      .formContainer {
        background-color: rgba(0, 0, 0, 0.504);
        z-index: 3;
        width: 60%;
        min-height: 100px;
        padding: 20px 50px;
        border-radius: 20px;
        position: fixed;
        top: 100px;
        left: 270px;
        right: auto;
        overflow-y: scroll; /* Değişiklik burada */
      }
      .formContainer2 {
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 3;
        width: 60%;
        min-height: 100px;
        padding: 50px 80px;
        border-radius: 20px;
        position: fixed;
        top: 160px;
        left: 300px;
        right: auto;
      }

      .scrollable-content {
        max-height: 600px;
        overflow-y: scroll; /* Dikey kaydırmayı etkinleştirin */
      }

    </style>
  </head>

  <body>
    <form class="userFormND container formContainer" id="addUserForm">
      <div class="scrollable-content"> <!-- Yeni eklenen div -->
        <div class="mb-3">
          <h1>ADD USER</h1>
          <div class="mb-3">
            <label for="nameOwner" class="form-label">Name:</label>
            <input type="text" class="form-control" id="nameUser" required />
          </div>
          <div class="mb-3">
            <label for="surnameOwner" class="form-label">Surname:</label>
            <input type="text" class="form-control" id="surnameUser" required />
          </div>
          <div class="mb-3">
            <label for="birthdateOwner" class="form-label">Birthdate:</label>
            <input type="date" class="form-control" id="birthdateUser" required />
          </div>
          <div class="mb-3">
            <label for="emailOwner" class="form-label">Email:</label>
            <input type="email" class="form-control" id="emailUser" required />
          </div>
          <div class="mb-3">
            <label for="passwordOwner" class="form-label">Password:</label>
            <input
              type="password"
              class="form-control"
              id="passwordUser"
              required
            />
          </div>
          <div class="mb-3">
            <label class="inp" for="genderAdmin">Gender</label>
            <input
              class=""
              type="radio"
              name="genderUser"
              id="maleid"
              value="male"
              required
            />
            Male
            <input
              class=""
              type="radio"
              name="genderUser"
              id="femaleid"
              value="female"
              required
            />
            Female
          </div>
          <div class="mb-3">
            <label for="identityNumberOwner" class="form-label"
              >Identity Number:</label
            >
            <input
              type="text"
              class="form-control"
              id="identityNumberUser"
              required
            />
          </div>
          <div class="mb-3">
            <label for="telOwner" class="form-label">Telephone Number:</label>
            <input type="tel" class="form-control" id="telUser" required />
          </div>
          <div class="mb-3">
            <label for="streetOwner" class="form-label">Street:</label>
            <input type="text" class="form-control" id="streetUser" required />
            <label for="districtOwner" class="form-label">District:</label>
            <input type="text" class="form-control" id="districtUser" required />
            <label for="cityOwner" class="form-label">City:</label>
            <input type="text" class="form-control" id="cityUser" required />
            <label for="countryOwner" class="form-label">Country:</label>
            <input type="text" class="form-control" id="countryUser" required />
          </div>
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    <form class="userFormND container formContainer" id="addAdminForm">
      <div class="scrollable-content"> <!-- Yeni eklenen div -->
        <div class="mb-3">
          <h1>ADD ADMIN</h1>
      <div class="mb-3">
        <label for="nameOwner" class="form-label">Name:</label>
        <input type="text" class="form-control" id="nameAdmin" required />
      </div>
      <div class="mb-3">
        <label for="surnameOwner" class="form-label">Surname:</label>
        <input type="text" class="form-control" id="surnameAdmin" required />
      </div>
      <div class="mb-3">
        <label for="birthdateOwner" class="form-label">Birthdate:</label>
        <input type="date" class="form-control" id="birthdateAdmin" required />
      </div>
      <div class="mb-3">
        <label for="emailOwner" class="form-label">Email:</label>
        <input type="email" class="form-control" id="emailAdmin" required />
      </div>
      <div class="mb-3">
        <label for="passwordOwner" class="form-label">Password:</label>
        <input
          type="password"
          class="form-control"
          id="passwordAdmin"
          required
        />
      </div>
      <div class="mb-3">
        <label class="inp" for="genderAdmin">Gender</label>
        <input
          class=""
          type="radio"
          name="genderAdmin"
          id="maleid"
          value="male"
          required
        />
        Male
        <input
          class=""
          type="radio"
          name="genderAdmin"
          id="femaleid"
          value="female"
          required
        />
        Female
      </div>
      <div class="mb-3">
        <label for="identityNumberOwner" class="form-label"
          >Identity Number:</label
        >
        <input
          type="text"
          class="form-control"
          id="identityNumberAdmin"
          required
        />
      </div>
      <div class="mb-3">
        <label for="telOwner" class="form-label">Telephone Number:</label>
        <input type="tel" class="form-control" id="telAdmin" required />
      </div>
      <div class="mb-3">
        <label for="streetOwner" class="form-label">Street:</label>
        <input type="text" class="form-control" id="streetAdmin" required />
        <label for="districtOwner" class="form-label">District:</label>
        <input type="text" class="form-control" id="districtAdmin" required />
        <label for="cityOwner" class="form-label">City:</label>
        <input type="text" class="form-control" id="cityAdmin" required />
        <label for="countryOwner" class="form-label">Country:</label>
        <input type="text" class="form-control" id="countryAdmin" required />
      </div>
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    <form class="userFormND container formContainer" id="addOwnerForm">
      <div class="scrollable-content"> <!-- Yeni eklenen div -->
        <div class="mb-3">
          <h1>ADD OWNER</h1>
      <div class="mb-3">
        <label for="nameOwner" class="form-label">Name:</label>
        <input type="text" class="form-control" id="nameOwner" required />
      </div>
      <div class="mb-3">
        <label for="surnameOwner" class="form-label">Surname:</label>
        <input type="text" class="form-control" id="surnameOwner" required />
      </div>
      <div class="mb-3">
        <label for="birthdateOwner" class="form-label">Birthdate:</label>
        <input type="date" class="form-control" id="birthdateOwner" required />
      </div>
      <div class="mb-3">
        <label for="emailOwner" class="form-label">Email:</label>
        <input type="email" class="form-control" id="emailOwner" required />
      </div>
      <div class="mb-3">
        <label for="passwordOwner" class="form-label">Password:</label>
        <input
          type="password"
          class="form-control"
          id="passwordOwner"
          required
        />
      </div>
      <div class="mb-3">
        <label class="inp" for="male">Gender</label>
        <input class="" type="radio" name="gender" id="maleid" value="male" required/>
        Male
        <input class="" type="radio" name="gender" id="femaleid" value="female" required/>
        Female
      </div>
      <div class="mb-3">
        <label for="identityNumberOwner" class="form-label"
          >Identity Number:</label
        >
        <input
          type="text"
          class="form-control"
          id="identityNumberOwner"
          required
        />
      </div>
      <div class="mb-3">
        <label for="telOwner" class="form-label">Telephone Number:</label>
        <input type="tel" class="form-control" id="telOwner" required />
      </div>
      <div class="mb-3">
        <label for="streetOwner" class="form-label">Street:</label>
        <input type="text" class="form-control" id="streetOwner" required />
        <label for="districtOwner" class="form-label">District:</label>
        <input type="text" class="form-control" id="districtOwner" required />
        <label for="cityOwner" class="form-label">City:</label>
        <input type="text" class="form-control" id="cityOwner" required />
        <label for="countryOwner" class="form-label">Country:</label>
        <input type="text" class="form-control" id="countryOwner" required />
      </div>
        </div>
      </div>
      
      <button type="submit" class="btn btn-primary">Submit</button>
    </form>

    <form class="userFormND container formContainer" id="userForm">
      <form class="userFormND container formContainer" id="userForm">
        <div class="scrollable-content"> <!-- Yeni eklenen div -->
          <div class="mb-3">
            <div class="mb-3">
              <label for="name" class="form-label">Name:</label>
              <input type="text" class="form-control" id="name" />
            </div>
            <div class="mb-3">
              <label for="surname" class="form-label">Surname:</label>
              <input type="text" class="form-control" id="surname" />
            </div>
            <div class="mb-3">
              <label for="birthdate" class="form-label">Birthdate:</label>
              <input type="date" class="form-control" id="birthdate" />
            </div>
            <div class="mb-3">
              <label for="email" class="form-label">Email:</label>
              <input type="email" class="form-control" id="email" />
            </div>
            <div class="mb-3">
              <label for="identityNumber" class="form-label">Identity Number:</label>
              <input type="text" class="form-control" id="identityNumber" />
            </div>
            <div class="mb-3">
              <label for="tel" class="form-label">Telephone Number:</label>
              <input type="tel" class="form-control" id="tel" />
            </div>
            <div class="mb-3">
              <label for="password" class="form-label">Password</label>
              <input type="text" class="form-control" id="password" />
            </div>
            <div class="mb-3">
              <label class="inp" for="male">Gender</label>
              <input class="" type="radio" name="gender" id="maleidd" value="male"/>
              Male
              <input class="" type="radio" name="gender" id="femaleidd" value="female"/>
              Female
            </div>
            <div class="mb-3">
              <label class="inp" for="male">Gender</label>
              <input class="" type="radio" name="auth" id="ownerid" value="owner"/>
              Owner
              <input class="" type="radio" name="auth" id="adminid" value="admin"/>
              Admin
              <input class="" type="radio" name="auth" id="userid" value="user"/>
              User
            </div>
            <div class="mb-3">
              <label for="street" class="form-label">Street:</label>
              <input type="text" class="form-control" id="street" />
              <label for="district" class="form-label">District:</label>
              <input type="text" class="form-control" id="district" />
              <label for="city" class="form-label">City:</label>
              <input type="text" class="form-control" id="city" />
              <label for="country" class="form-label">Country:</label>
              <input type="text" class="form-control" id="country" />
            </div>
            <div class="mb-3">
              <label for="iban" class="form-label">IBAN:</label>
              <input type="text" class="form-control" id="iban" />
            </div>
            <div class="mb-3">
              <label for="balance" class="form-label">Balance:</label>
              <input type="text" class="form-control" id="balance" />
            </div>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    
    </form>

    <div class="p-0 py-3 container-fluid">
      <nav>
        <div class="row">
          <div class="col-lg-12 d-flex justify-content-center">
            <h1>
              <span class="adminName" id="adminName"></span> Welcome to LUX Bank
              Admin Panel
            </h1>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
            <ul class="tabs d-flex justify-content-center">
              <li>
                <button style="border: 1px solid black; padding: 10px" class="but active users" onclick="isActive">
                  Users
                </button>
              </li>
              <li>
                <button style="border: 1px solid black; padding: 10px" class="but close carts" onclick="isActive" >
                  Carts
                </button>
              </li>

              <li>
                <button style="border: 1px solid black; padding: 10px" class="but close createCredit" onclick="isActive">
                  Create Credit
                </button>
              </li>

              <li>
                <button style="border: 1px solid black; padding: 10px" class="but close creditapply" onclick="isActive">
                  Credit Applies
                </button>
              </li>

              <li>
                <button style="border: 1px solid black; padding: 10px" class="but close history" onclick="isActive">
                  Admin Process History
                </button>
              </li>
              <li>
                <button style="border: 1px solid black; padding: 10px" class="but close transferhistory" onclick="isActive">
                  Money Transfer History
                </button>
              </li>

              <li>
                <button style="border: 1px solid black; padding: 10px" class="but close carousel" onclick="isActive">
                  Add Carousel
                </button>
              </li>


            </ul>
          </div>
        </div>
      </nav>

      <main>
        <div class="row px-5">
          <ul class="">

            <li class="isVisible visible" id="usersSec" style="width: 100%">
              <div class="row">
                <div class="d-flex justify-content-between align-items-center">
                  <h1>Owners</h1>
                  <button style="font-size: 20px; border: 1px solid black; border-radius: 100%; padding: 0px 10px;" onclick="addNewOwner()">+</button>
                </div>
                <div class="col-lg-12">
                  <form id="ownerSearch" style="padding: 0 250px">
                    <div class="input-group mb-3">
                      <select class="btn btn-secondary" id="ownerOpt" name="infosSel">
                        <option value="id">ID</option>
                        <option value="name">NAME</option>
                        <option value="identity">IDENTITY</option>
                        <option value="email">EMAIL</option>
                        <option value="tel">TEL</option>
                        <option value="iban">IBAN</option>
                        <option value="debt">DEBT NAME</option>
                      </select>
                      <input style="border: 1px solid black" type="text" class="form-control" placeholder="Search" name="search" id="searchOwner"/>
                      <button class="btn btn-primary" type="submit">Search</button>
                      <button class="btn btn-primary" type="reset">Reset</button>
                    </div>
                  </form>
                </div>
                <div style="width: 100%; overflow-y: scroll; overflow-x: scroll; max-height: 400px;">
                  <table id="ownertable" border="1" style="width: 100%; overflow-y: scroll;">
                    <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Gender</th>
                      <th>Birth Date</th>
                      <th>Email</th>
                      <th>Identity</th>
                      <th>Tel No</th>
                      <th>Adress</th>
                      <th>IBAN</th>
                      <th>Balance</th>
                      <th>Debts</th>
                      <th>Carts</th>
                      <th>Actions</th>
                    </tr>
                  </table>
                </div>
              </div>
            
              <div class="row">
                <div class="d-flex justify-content-between align-items-center">
                  <h1>Admins</h1>
                  <button style="font-size: 20px; border: 1px solid black; border-radius: 100%; padding: 0px 10px;" onclick="addNewAdmin()">+</button>
                </div>

                <div class="col-lg-12">
                  <form id="adminSearch" style="padding: 0 250px">
                    <div class="input-group mb-3">
                      <select class="btn btn-secondary" id="adminOpt" name="infosSel">
                        <option value="id">ID</option>
                        <option value="name">NAME</option>
                        <option value="identity">IDENTITY</option>
                        <option value="email">EMAIL</option>
                        <option value="tel">TEL</option>
                        <option value="iban">IBAN</option>
                        <option value="debt">DEBT NAME</option>
                      </select>
                      <input style="border: 1px solid black" type="text" class="form-control" placeholder="Search" name="search" id="searchAdmin"
                      />
                      <button class="btn btn-primary" type="submit">Search</button>
                      <button class="btn btn-primary" type="reset">Reset</button>
                    </div>
                  </form>
                </div>

                <div style="width: 100%; overflow-y: scroll; max-height: 500px; overflow-y: scroll;">
                  <table id="admintable" border="1" style="width: 100%">
                    <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Gender</th>
                      <th>Birth Date</th>
                      <th>Email</th>
                      <th>Identity</th>
                      <th>Tel No</th>
                      <th>Adress</th>
                      <th>IBAN</th>
                      <th>Balance</th>
                      <th>Debts</th>
                      <th>Carts</th>
                      <th>Actions</th>
                    </tr>
                  </table>
                </div>
              </div>
            
              <div class="row">
                <div class="d-flex justify-content-between align-items-center">
                  <h1>Users</h1>
                  <button style="font-size: 20px; border: 1px solid black; border-radius: 100%; padding: 0px 10px;" onclick="addNewUser()">+</button>
                </div>

                <div class="col-lg-12">
                  <form id="userSearch" style="padding: 0 250px">
                    <div class="input-group mb-3">
                      <select class="btn btn-secondary" id="userOpt" name="infosSel">
                        <option value="id">ID</option>
                        <option value="name">NAME</option>
                        <option value="identity">IDENTITY</option>
                        <option value="email">EMAIL</option>
                        <option value="tel">TEL</option>
                        <option value="iban">IBAN</option>
                        <option value="debt">DEBT NAME</option>
                      </select>
                      <input style="border: 1px solid black" type="text" class="form-control" placeholder="Search" name="search" id="searchUser"/>
                      <button class="btn btn-primary" type="submit">Search</button>
                      <button class="btn btn-primary" type="reset">Reset</button>
                    </div>
                  </form>
                </div>

                <div style="width: 100%; overflow-y: scroll; max-height: 500px; overflow-y: scroll;">
                  <table id="usertable" border="1" style="width: 100%">
                    <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Gender</th>
                      <th>Birth Date</th>
                      <th>Email</th>
                      <th>Identity</th>
                      <th>Tel No</th>
                      <th>Adress</th>
                      <th>IBAN</th>
                      <th>Balance</th>
                      <th>Debts</th>
                      <th>Carts</th>
                      <th>Actions</th>
                    </tr>
                  </table>
                </div>
              </div>
            </li>
            

            <li class="isVisible noVisible" id="cartsSec">
              <div class="row" id="applications">
                <!-- <div class="col-lg-3">
                  <ul class="mt-3">
                    <li>APPLICATION ID :</li>
                    <li>USER ID :</li>
                    <li>USER NAME :</li>
                    <li>USER BALANCE :</li>
                    <li>USER DEBTS :</li>
                    <li class="d-flex">
                      <button
                        class="btn btn-success my-2 mr-3"
                        onclick="accept(id)"
                      >
                        Accept
                      </button>
                      <button
                        class="btn btn-danger my-2 mx-3"
                        onclick="cancel(id)"
                      >
                        Cancel
                      </button>
                    </li>
                  </ul>
                </div> -->
              </div>
            </li>

            <li class="isVisible noVisible w-100" id="historySec">
              <div class="row">
                <div class="col-lg-12" style="position: fixed">
                  <form id="searchForm" style="padding: 0 250px">
                    <div class="input-group mb-3">
                      <select class="btn btn-secondary" name="types" id="typesSel">
                        <option value="all">ALL</option>
                        <option value="adding">ADDING</option>
                        <option value="updating">UPDATING</option>
                        <option value="deleting">DELETING</option>
                        <option value="cardapplication">CARD APPLICATIONS</option>
                        <option value="creditapplication">CREDIT APPLICATIONS</option>
                      </select>
                      <select class="btn btn-secondary" id="infosSel" name="infosSel">
                        <option value="adminid">ADMIN ID</option>
                        <option value="userid">USER ID</option>
                        <option value="processid">PROCESS ID</option>
                        <option value="adminname">ADMIN NAME</option>
                        <option value="username">USER NAME</option>
                      </select>
                      <input style="border: 1px solid black" type="text" class="form-control" placeholder="Search" name="search" id="searchProcess"
                      />
                      <button class="btn btn-primary" type="submit">Search</button>
                      <button class="btn btn-primary" type="reset">Reset</button>
                    </div>
                  </form>
                </div>
              </div>

              <div class="row" style="margin-top: 100px">
                <div class="col-lg-12" id="historyDatas">
                  <!-- <ul class="adding"
                                    style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                    <li>Type: <span style="font-weight: 550;">adding</span></li>
                                    <li>Process: <span style="font-weight: 550;">user named 333 333 with id
                                            647c9b0491a4c9b91b25a527 with user
                                            authorization has
                                            been added by Lucifer Morningstar with id 666 with auth owner </span></li>
                                    <li>Process Date: <span style="font-weight: 550;">2023-06-04T13:32:24.821Z</span>
                                    </li>
                                </ul>
                                <ul class="updating"
                                    style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                    <li>Type: <span style="font-weight: 550;">updating</span></li>
                                    <li>Process:
                                        <span style="font-weight: 550;"> "user named 2 2 with id
                                            647c928851122091ad04e80c with owner
                                            authorization has been updated by Lucifer Morningstar with id 666 with auth
                                            owner.</span>
                                    </li>
                                    <li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">
                                            "name": "2u",
                                            "surname": "2u",
                                            "birthdate": "2222-02-22",
                                            "email": "2u@2u",
                                            "identityNumber": "2",
                                            "tel": "2",
                                            "password": "password",
                                            "street": "2u",
                                            "district": "2u",
                                            "city": "2u",
                                            "country": "2u"
                                        </span>

                                    </li>
                                    <li>Process Date: <span style="font-weight: 550;">2023-06-04T13:32:24.821Z</span>
                                    </li>
                                </ul>
                                <ul class="deleting"
                                    style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                    <li>Type: <span style="font-weight: 550;">deleting</span></li>
                                    <li>Process: <span style="font-weight: 550;">"user named 333 333 with id
                                            647c932b51122091ad04e833 with user
                                            authorization has been deleted by Lucifer Morningstar with id 666 with auth
                                            owner</span></li>
                                    <li>Process Date: <span style="font-weight: 550;">2023-06-04T13:32:24.821Z</span>
                                    </li>
                                </ul> -->
                </div>
              </div>
            </li>

            <li class="isVisible noVisible w-100" id="transferSec">
              <div class="row">
                <div class="col-lg-12" style="position: fixed; z-index: 1;">
                  <form id="searchForm2" style="padding: 0 250px">
                    <div class="input-group mb-3">
                      <select class="btn btn-secondary" id="infomoney" name="infomoney">
                        <option value="senderid">SENDER ID</option>
                        <option value="receiverid">RECEIVER ID</option>
                        <option value="processid">PROCESS ID</option>
                        <option value="sendername">SENDER NAME</option>
                        <option value="receivername">RECEIVER NAME</option>
                      </select>
                      <input style="border: 1px solid black" type=" text" class="form-control" placeholder="Search" name="search" id="searchmoney"/>
                      <button class="btn btn-primary" type="submit">
                        Search
                      </button>
                      <button class="btn btn-primary" type="reset">
                        Reset
                      </button>
                    </div>
                  </form>
                </div>
              </div>

              <div class="row mt-5" id="transferPlace">
                <!-- <div class="col-lg-4">
                  <ul>
                    <li><span style="font-weight: 600;">SENDER ID: </span><span>123124ıpjsdjsd12354</span></li>
                    <li><span style="font-weight: 600;">SENDER NAME: </span><span>Kabil Morningstar</span></li>
                    <li><span style="font-weight: 600;">AMOUNT: </span><span>5.00</span></li>
                    <li><span style="font-weight: 600;">SENDER OLD BALANCE: </span><span>6.00</span></li>
                    <li><span style="font-weight: 600;">SENDER NEW BALANCE: </span><span>1.00</span></li>
                  </ul>

                  <ul>
                    <li><span style="font-weight: 600;">RECEIVER ID: </span><span>123124ıpjsdjsd12354</span></li>
                    <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>Habil Allahstar</span></li>
                    <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>4.00</span></li>
                    <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>9.00</span></li>
                  </ul>
                  
                  <ul>
                    <li><span style="font-weight: 600;">PROCESS: </span><span>User named Kabil Morningstar sent 5.00 Money to Habil Allahstar</span></li>
                    <li><span style="font-weight: 600;">DATE: </span><span>2006</span></li>
                  </ul>
                </div> -->
              </div>
            </li>

            <li class="isVisible noVisible w-100" id="createCreditSec">
              <div id="createCreditDiv" class="noVisible formContainer2">
                <form class=" container" id="createCreditForm" >
                  <input type="text" class="form-control mb-3" placeholder="Name" id="creditname" value="name">
                  <textarea type="text" class="form-control mb-3" placeholder="Name" id="credittext" value="name"></textarea>
                  <input type="text" class="form-control mb-3" placeholder="Credit Amount" id="creditamount" value="1000">
                  <input type="text" class="form-control mb-3" placeholder="Credit Interest" id="creditinterest" value="7">
                  <input type="text" class="form-control mb-3" placeholder="Credit Year" id="credityear" value="12">
                  <input type="text" class="form-control mb-3" placeholder="Installment Month" id="creditinstallmentmonth" value="1">
                  <div class="w-100 d-flex justify-content-center">
                    <button class="btn btn-primary mx-2" style="width: 130px;" type="submit">Submit</button>
                    <button class="btn btn-danger mx-2" type="reset">Cancel</button>
                  </div>
                </form>
               
              </div>

              <div class="row">
                <div class="col-lg-12 d-flex justify-content-center" style="position: fixed; z-index: 2;">
                  <button class="btn btn-primary" id="createNewCreditButton">Create New Credit</button>
                </div>
              </div>

              <div class="row">
                <div class="col-lg-12" style="position: fixed; z-index: 1; top: 180px;">
                  <form id="searchForm3" style="padding: 0 250px">
                    <div class="input-group mb-3">
                      <select class="btn btn-secondary" id="infocredit" name="infocredit">
                        <option value="creditid">CREDIT ID</option>
                        <option value="creditname">CREDIT NAME</option>
                      </select>
                      <input style="border: 1px solid black" type=" text" class="form-control" placeholder="Search" name="searchcredit" id="searchcredit"/>
                      <button class="btn btn-primary" type="submit">Search</button>
                      <button class="btn btn-primary" type="reset">Reset</button>
                    </div>
                  </form>
                </div>
              </div>

              <div class="row" style="margin-top: 115px;" id="creditsPlace">
                <!-- <div class="col-lg-4">
                  <ul class="d-flex justify-content-center align-items-center flex-column" style="text-align: left;">
                    <div>
                      <li><span style="font-weight: 550; font-size: 18px;">CREDIT NAME:</span> <span>Bengüsu</span></li>
                      <li><span style="font-weight: 550;">CREDIT AMOUNT:</span> <span>1000</span></li>
                      <li><span style="font-weight: 550;">CREDIT INTEREST:</span> <span>%7</span></li>
                      <li><span style="font-weight: 550;">CREDIT EXPIRATION MONTH:</span> <span>12</span></li>
                      <li><span style="font-weight: 550;">CREDIT INSTALLMENT MONTH:</span> <span>1</span></li>
                      <li><span style="font-weight: 550;">CREDIT CALCULATED INTEREST:</span> <span>70</span></li>
                      <li><span style="font-weight: 550;">SUM AMOUNT TO PAY:</span> <span>1070</span></li>
                      <li><span style="font-weight: 550;">PAYMENT INTERVAL:</span> <span>12</span></li>
                      <li><span style="font-weight: 550;">PAYMENT AMOUNT PER INTERVAL:</span> <span>89</span></li>
                    </div>
                    <div class="d-flex justify-content-end my-2">
                      <button onclick="update(item._id)" class="btn btn-primary mx-3">Update</button>
                      <button onclick="del(item_id)" class="btn btn-danger">Delete</button>
                    </div>
                  </ul>
                </div> -->
              </div>
            </li>

            <li class="isVisible noVisible" id="creditapplySec">
              <h1>
                Credit Apply Sec
              </h1>
              <div class="row" id="creditapplicationsplace">
                <!-- <div class="col-lg-3">
                  <ul class="mt-3">
                    <li>APPLICATION ID :</li>
                    <li>USER ID :</li>
                    <li>USER NAME :</li>
                    <li>USER BALANCE :</li>
                    <li>USER DEBTS :</li>
                    <li class="d-flex">
                      <button
                        class="btn btn-success my-2 mr-3"
                        onclick="accept(id)"
                      >
                        Accept
                      </button>
                      <button
                        class="btn btn-danger my-2 mx-3"
                        onclick="cancel(id)"
                      >
                        Cancel
                      </button>
                    </li>
                  </ul>
                </div> -->
              </div>
            </li>

            <li class="isVisible noVisible" id="carouselSec">
              <h1>
                Add Carousel Sec
              </h1>
              <div class="row" id="carouselPlace">
                <div class="col-lg-12 d-flex justify-content-center">
                  <form action="/panel/addcarousel" name="carousel" method="post" enctype="multipart/form-data">
                    <input type="file" name="carousel">
                    <button type="submit">Submit</button>
                  </form>
                </div>

                <div class="row my-5" id="carouselthing">
                  <!-- <div class="col-lg-6">
                    <img src="/investmenteducations.png" alt="" width="100%">
                    <button class="btn btn-primary my-1" onclick="status()">Active</button>
                    <button class="btn btn-danger my-1" onclick="deletecarousel()">Delete</button>
                    <form action="#">
                      <input type="text" placeholder="Add link" id="addlink">
                      <button type="submit">Submit</button>
                    </form>
                  </div> -->
                </div>
              </div>
            </li>
          </ul>
        </div>
      </main>
    </div>

 <!-- CAROUSEL -->

<script>
  // Carousel durumunu değiştiren işlev
  const status = (id) => {
    const url = `/panel/carouselactive/${id}`;
    
    // Sunucuya istek göndererek carousel durumunu değiştir
    fetch(url, { method: "post" })
      .then(res => res.json())
      .then(data => {
        if (data.msg === "success") {
          alert("Successfully Changed to " + data.status);
          location.reload();
        }
        else {
          alert("An error occurred: " + data.message);
        }
      })
      .catch(err => console.log(err));
  };

  // Carousel'ı silen işlev
  const deletecarousel = (id) => {
    const confirmed = confirm("Are you sure?");
    if (confirmed) {
      const url = `/panel/carouseldelete/${id}`;
      
      // Sunucuya istek göndererek carousel'ı sil
      fetch(url, { method: "post" })
        .then(res => res.json())
        .then(data => {
          if (data.msg === "success") {
            alert("Successfully Deleted");
            location.reload();
          }
          else {
            alert("An error occurred: " + data.message);
          }
        })
        .catch(err => console.log(err));
    }
  };

  const carouselPlace = document.getElementById("carouselthing");
  
  // Sunucudan carousel verilerini al
  fetch("/api/carouselsadmin", { method: "post" })
    .then(res => res.json())
    .then(data => {
      console.log(data);
      // Carousel verilerini döngüyle işle
      data.forEach((item, index) => {
        const pfpPath = item.path;
        const fileName = pfpPath.split("\\").slice(-1)[0];
        const formId = `linkform-${index}`;
        
        // Carousel öğesini HTML'e ekle
        carouselPlace.innerHTML += `
          <div class="col-lg-6">
            <img src="/${fileName}" alt="" width="100%">
            ${item.active ? `<button class="btn btn-primary my-1" onclick="status('${item._id}')">Disable</button>` : `<button class="btn btn-secondary my-1" onclick="status('${item._id}')">Active</button>`}
            <button class="btn btn-danger my-1" onclick="deletecarousel('${item._id}')">Delete</button>
            <span>Link : ${item.link}</span>
            <form action="#" id="${item._id}">
              <input type="text" placeholder="Add link" class="inputlink">
              <button type="submit">Submit</button>
            </form>
          </div>
        `;
      });
    })
    .catch(err => {
      console.log(err);
    });

  carouselPlace.addEventListener("submit", (e) => {
    e.preventDefault();
    if (e.target.tagName === "FORM") {
      const form = e.target;
      const input = form.querySelector(".inputlink");
      const linkValue = input.value;
      console.log(linkValue + e.target.id);
      if (linkValue !== "") {
        const params = {
          link: linkValue,
          id: e.target.id
        };
        const urlParams = new URLSearchParams(params);
        const url = `/panel/addlink?${urlParams}`;
        
        // Sunucuya istek göndererek carousel'a link ekle
        fetch(url, { method: "post" })
          .then(res => res.json())
          .then(data => {
            console.log(data);
            if (data.msg === "success") {
              alert("Successfully link changed");
              location.reload();
            }
            else {
              alert("An error occurred: " + data.msg);
            }
          })
          .catch(err => console.log(err));
      }
    }
  });
</script>


<!-- CREDIT APPLICATIONS -->

<script>
  const creditapplicationsplace = document.getElementById("creditapplicationsplace");
  
  // Başvuruyu işleyen işlev
  const process = (id, isAccepted) => {
    const confirmed = confirm("Are you sure?");
    if (confirmed) {
      const params = {
        id,
        isAccepted
      };
      const urlParams = new URLSearchParams(params);
      const url = `/panel/creditapplication?${urlParams}`;
      
      // Sunucuya istek göndererek kredi başvurusunu işle
      fetch(url, { method: "post" })
        .then(res => res.json())
        .then(data => {
          if (data.msg === "success") {
            alert("Application Successfully Accepted");
            location.reload();
          }
          else if (data.msg === "cancelled") {
            alert("Application Successfully Cancelled");
            location.reload();
          }
          else if (data.msg === "notenoughmoney") {
            alert("User Has Not Enough Money");
          }
          else {
            alert("An Error Occurred, Try Again Later");
          }
        })
        .catch(err => console.log(`[AN ERROR OCCURRED ON PROCESS] ${err}`));
    }
  };

  // Kredi başvurularını sunucudan al
  fetch("/api/creditapplications", { method: "post" })
    .then(res => res.json())
    .then(data => {
      let balances = [];
      let users = [];
      let credits = [];
      
      // Kullanıcı bakiyelerini, kullanıcıları ve kredileri eşleştir
      data.creditapplications.map((applys, i) => balances.push(data.balances.find(bln => applys.userID === bln.userID)));
      data.creditapplications.map((applys, i) => users.push(data.users.find(bln => applys.userID === bln._id)));
      data.creditapplications.map((applys, i) => credits.push(data.credit.find(bln => applys.creditID === bln._id)));

      data.creditapplications.forEach((item, i) => {
        creditapplicationsplace.innerHTML += `
          <div class="col-lg-4">
            <ul class="mt-3">
              <li>APPLICATION ID : ${item._id}</li>
              <li>USER ID : ${item.userID}</li>
              <li>CREDIT ID : ${item.creditID}</li>
              <li>CREDIT NAME : ${credits[i].creditname}</li>
              <li>USER NAME : ${users[i].name} ${users[i].surname}</li>
              <li>USER BALANCE : ${parseFloat(balances[i].balance.$numberDecimal).toFixed(2)}</li>
              <li>USER DEBTS : ${JSON.stringify(balances[i].debts.map(item => item.creditname))}
              <li class="d-flex">
                <button
                  class="btn btn-success my-2 mr-3"
                  onclick="process('${item._id}', 'accepted')"
                >
                  Accept
                </button>
                <button
                  class="btn btn-danger my-2 mx-3"
                  onclick="process('${item._id}', 'cancelled')"
                >
                  Cancel
                </button>
              </li>
            </ul>
          </div>
        `;
      });
    })
    .catch(err => console.log(`[AN ERROR OCCURRED ON GETTING CREDIT APPLICATIONS] ${err}`));
</script>

    <!-- GET CREDITS -->

    <script>
      const creditsPlace = document.getElementById("creditsPlace"); // "creditsPlace" ID'sine sahip HTML elementini seçer
    const form3 = document.getElementById("searchForm3"); // "searchForm3" ID'sine sahip HTML elementini seçer

    fetch("/api/credits", { method: "post" }) // "/api/credits" endpointine bir POST isteği yapar
      .then(res => res.json()) // Yanıt verisini JSON olarak ayrıştırır
      .then(data => { // Ayrıştırılmış JSON verisiyle bir geriçağırma işlevini çalıştırır
        data.forEach(item => { // Her bir öğe için veri dizisini döngüye alır
          // Şablon dizelerini kullanarak HTML içeriği dinamik olarak oluşturur ve "creditsPlace" öğesini oluşturulan içerikle doldurur
          creditsPlace.innerHTML += `
            <div class="col-lg-4">
                <ul class="d-flex justify-content-center align-items-center flex-column">
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT ID:</span> <span>${item._id}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT NAME:</span> <span>${item.creditname}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT AMOUNT:</span> <span>${parseFloat(item.creditamount.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT INTEREST:</span> <span>${parseFloat(item.creditinterest.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT EXPIRATION MONTH: </span><span>${item.creditexpirationmonth}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT INSTALLMENT MONTH: </span><span>${item.creditinstallmentmonth}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT CALCULATED INTEREST: </span><span>${parseFloat(item.interestCalculated.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">SUM AMOUNT TO PAY: </span> <span>${parseFloat(item.sumAmountToPay.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">PAYMENT INTERVAL: </span> <span>${item.paymentInterval}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">PAYMENT AMOUNT PER INTERVAL: </span><span>${parseFloat(item.paymentAmountPerInterval.$numberDecimal).toFixed(2)}</span></li>
                    <div class="d-flex justify-content-end my-2">
                      <button onclick="creditprocess('${item._id}', 'active')" class="btn btn-primary">${item.creditActive ? "Disable" : "Active"}</button>
                      <button onclick="creditprocess('${item._id}', 'delete')" class="btn btn-danger">Delete</button>
                    </div>
                </ul>
              </div>`;
        })
        let type = ""; // Arama türünü tutmak için değişken tanımlanır

// "infocredit" kimliğine sahip öğenin değişiklik olayını dinleyen bir işleyici atanır
document.getElementById("infocredit").addEventListener("change", (e) => {
  type = e.target.value; // Arama türü değişkenine seçilen değer atanır
});

// "form3" kimliğine sahip formun gönderme olayını dinleyen bir işleyici atanır
form3.addEventListener("submit", (e) => {
  e.preventDefault();

  const prompt = document.getElementById("searchcredit").value; // Arama metni alınır
  creditsPlace.innerHTML = ""; // Sonuçları temizlemek için "creditsPlace" öğesinin içeriği boşaltılır

  if (prompt === "") {
    // Arama metni boşsa, tüm verileri görüntüler
    data.forEach((item) => {
      // Şablon dizelerini kullanarak HTML içeriği dinamik olarak oluşturur ve "creditsPlace" öğesini oluşturulan içerikle doldurur
      creditsPlace.innerHTML += `
        <div class="col-lg-4">
          <ul class="d-flex justify-content-center align-items-center flex-column">
              <li><span style="font-weight: 550; font-size: 18px;">CREDIT ID:</span> <span>${item._id}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">CREDIT NAME:</span> <span>${item.creditname}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">CREDIT AMOUNT:</span> <span>${parseFloat(item.creditamount.$numberDecimal).toFixed(2)}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">CREDIT INTEREST:</span> <span>${parseFloat(item.creditinterest.$numberDecimal).toFixed(2)}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">CREDIT EXPIRATION MONTH: </span><span>${item.creditexpirationmonth}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">CREDIT INSTALLMENT MONTH: </span><span>${item.creditinstallmentmonth}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">CREDIT CALCULATED INTEREST: </span><span>${parseFloat(item.interestCalculated.$numberDecimal).toFixed(2)}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">SUM AMOUNT TO PAY: </span> <span>${parseFloat(item.sumAmountToPay.$numberDecimal).toFixed(2)}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">PAYMENT INTERVAL: </span> <span>${item.paymentInterval}</span></li>
              <li><span style="font-weight: 550; font-size: 18px;">PAYMENT AMOUNT PER INTERVAL: </span><span>${parseFloat(item.paymentAmountPerInterval.$numberDecimal).toFixed(2)}</span></li>
              <div class="d-flex justify-content-end my-2">
                <button onclick="creditprocess('${item._id}', 'active')" class="btn ${item.creditActive ? "btn-primary" : "btn-secondary"}">${item.creditActive ? "Disable" : "Active"}</button>
                <button onclick="creditprocess('${item._id}', 'delete')" class="btn btn-danger">Delete</button>
              </div>
          </ul>
        </div>`;
    });
  } else {
    if (type === "") {
      type = "creditid"; // Varsayılan arama türü "creditid" olarak atanır
    }

    let filtered = [];
    switch (type) {
      case "creditid":
        // Kredi ID'sine göre filtreleme yapılır
        filtered = data.filter((item) => item._id === prompt);
        if (filtered.length > 0) {
          // Filtrelenmiş sonuçları görüntüler
          filtered.forEach((item) => {
            creditsPlace.innerHTML += `
              <div class="col-lg-4">
                <ul class="d-flex justify-content-center align-items-center flex-column">
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT ID:</span> <span>${item._id}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT NAME:</span> <span>${item.creditname}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT AMOUNT:</span> <span>${parseFloat(item.creditamount.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT INTEREST:</span> <span>${parseFloat(item.creditinterest.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT EXPIRATION MONTH: </span><span>${item.creditexpirationmonth}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT INSTALLMENT MONTH: </span><span>${item.creditinstallmentmonth}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT CALCULATED INTEREST: </span><span>${parseFloat(item.interestCalculated.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">SUM AMOUNT TO PAY: </span> <span>${parseFloat(item.sumAmountToPay.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">PAYMENT INTERVAL: </span> <span>${item.paymentInterval}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">PAYMENT AMOUNT PER INTERVAL: </span><span>${parseFloat(item.paymentAmountPerInterval.$numberDecimal).toFixed(2)}</span></li>
                    <div class="d-flex justify-content-end my-2">
                      <button onclick="creditprocess('${item._id}', 'active')" class="btn btn-primary">${item.creditActive ? "Disable" : "Active"}</button>
                      <button onclick="creditprocess('${item._id}', 'delete')" class="btn btn-danger">Delete</button>
                    </div>
                </ul>
              </div>`;
          });
        } else {
          creditsPlace.innerHTML = "<h1>NO DATA FOUND</h1>";
        }
        break;
      case "creditname":
        // Kredi adına göre filtreleme yapılır
        filtered = data.filter((item) => item.creditname === prompt);
        if (filtered.length > 0) {
          // Filtrelenmiş sonuçları görüntüler
          filtered.forEach((item) => {
            creditsPlace.innerHTML += `
              <div class="col-lg-4">
                <ul class="d-flex justify-content-center align-items-center flex-column">
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT ID:</span> <span>${item._id}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT NAME:</span> <span>${item.creditname}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT AMOUNT:</span> <span>${parseFloat(item.creditamount.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT INTEREST:</span> <span>${parseFloat(item.creditinterest.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT EXPIRATION MONTH: </span><span>${item.creditexpirationmonth}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT INSTALLMENT MONTH: </span><span>${item.creditinstallmentmonth}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">CREDIT CALCULATED INTEREST: </span><span>${parseFloat(item.interestCalculated.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">SUM AMOUNT TO PAY: </span> <span>${parseFloat(item.sumAmountToPay.$numberDecimal).toFixed(2)}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">PAYMENT INTERVAL: </span> <span>${item.paymentInterval}</span></li>
                    <li><span style="font-weight: 550; font-size: 18px;">PAYMENT AMOUNT PER INTERVAL: </span><span>${parseFloat(item.paymentAmountPerInterval.$numberDecimal).toFixed(2)}</span></li>
                    <div class="d-flex justify-content-end my-2">
                      <button onclick="creditprocess('${item._id}', 'active')" class="btn btn-primary">${item.creditActive ? "Disable" : "Active"}</button>
                      <button onclick="creditprocess('${item._id}', 'delete')" class="btn btn-danger">Delete</button>
                    </div>
                </ul>
              </div>`;
          });
        } else {
          creditsPlace.innerHTML = "<h1>NO DATA FOUND</h1>";
        }
        break;
    }
  }
});


        form3.addEventListener("reset", () => {
          // console.log("reset")
          creditsPlace.innerHTML = ""
          data.forEach(item => {
            creditsPlace.innerHTML += `
            <div class="col-lg-4">
              <ul class="d-flex justify-content-center align-items-center flex-column">
                  <li><span style="font-weight: 550; font-size: 18px;">CREDIT ID:</span> <span>${item._id}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">CREDIT NAME:</span> <span>${item.creditname}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">CREDIT AMOUNT:</span> <span>${parseFloat(item.creditamount.$numberDecimal).toFixed(2)}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">CREDIT INTEREST:</span> <span>${parseFloat(item.creditinterest.$numberDecimal).toFixed(2)}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">CREDIT EXPIRATION MONTH: </span><span>${item.creditexpirationmonth}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">CREDIT INSTALLMENT MONTH: </span><span>${item.creditinstallmentmonth}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">CREDIT CALCULATED INTEREST: </span><span>${parseFloat(item.interestCalculated.$numberDecimal).toFixed(2)}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">SUM AMOUNT TO PAY: </span> <span>${parseFloat(item.sumAmountToPay.$numberDecimal).toFixed(2)}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">PAYMENT INTERVAL: </span> <span>${item.paymentInterval}</span></li>
                  <li><span style="font-weight: 550; font-size: 18px;">PAYMENT AMOUNT PER INTERVAL: </span><span>${parseFloat(item.paymentAmountPerInterval.$numberDecimal).toFixed(2)}</span></li>
                  <div class="d-flex justify-content-end my-2">
                    <button onclick="creditprocess('${item._id}')" class="btn btn-danger">Delete</button>
                  </div>
              </ul>
            </div>`
          })
        })
      
      })
      .catch(err => console.log(`[AN ERROR OCCURRED ON GETTING CREDITS] ${err}`))

      const creditprocess = (id, process) => {
        const confirmed = confirm("Are you sure?")
        if(confirmed){  
          const params = {
            id,
            process
          }
          const urlparams = new URLSearchParams(params)
          const url = `/panel/processcredit?${urlparams}`
          fetch(url, {method: "post"})
          .then(res => res.json())
          .then(data => {
            if(data.msg === "deleted"){
              alert("SUCCESSFULLY DELETED")
              location.reload()
            }
            else if(data.msg === "changed"){
              alert(`SUCCESSFULLY ${data.status}`)
              location.reload()
            }
            else{
              alert("AN ERROR OCCURRED ON PROCESS :" + data.msg )
            }
          })
          .catch(err => console.log(`[AN ERROR OCCURRED ON PROCESSING DATA] - [URL] ${url} - [ERR] ${err}`))
        }
      
      } 

    </script>
  
    <!-- CREATING CREDIT -->
     
<script>
  // HTML elementlerini alırız
  const createCreditBut = document.getElementById("createNewCreditButton");
  const createCreditDiv = document.getElementById("createCreditDiv");
  const createCreditForm = document.getElementById("createCreditForm");

  // Yeni Kredi Oluştur butonuna bir olay dinleyicisi ekleriz
  createCreditBut.addEventListener("click", () => {
    // Kredi oluşturma formunun görünürlüğünü değiştiririz
    if (createCreditDiv.classList.contains("noVisible")) {
      createCreditDiv.classList.remove("noVisible");
      createCreditDiv.classList.add("visible");
    } else {
      createCreditDiv.classList.remove("visible");
      createCreditDiv.classList.add("noVisible");
    }
  });

  // Kredi oluşturma formunun gönderme olayını dinleriz
  createCreditForm.addEventListener("submit", (e) => {
    e.preventDefault(); // Sayfanın yeniden yüklenmesini engelleriz
    try {
      // Formdan gerekli verileri alırız
      const creditname = document.getElementById("creditname").value;
      const creditdescription = document.getElementById("credittext").value;
      const creditamount = parseFloat(document.getElementById("creditamount").value);
      const creditinterest = parseFloat(document.getElementById("creditinterest").value);
      const creditexpirationmonth = parseInt(document.getElementById("credityear").value);
      const creditinstallmentmonth = parseInt(document.getElementById("creditinstallmentmonth").value);

      // Girilen değerlerin sayısal olup olmadığını kontrol ederiz
      if (isNaN(creditamount) || isNaN(creditinterest) || isNaN(creditexpirationmonth) || isNaN(creditinstallmentmonth)) {
        throw new TypeError("Please enter a valid numeric value");
      }

      // Kredi süresi ve taksit sayısı arasında uyum kontrolü yapılır
      if (creditexpirationmonth % creditinstallmentmonth == 0) {
        // Faiz hesaplanır
        const interestCalculated = (creditamount * creditinterest) / 100;
        // Ödenecek toplam tutar hesaplanır
        const sumAmountToPay = creditamount + interestCalculated;
        // Ödeme aralığı hesaplanır
        const paymentInterval = creditexpirationmonth / creditinstallmentmonth;
        // Her bir ödeme aralığı için ödenecek tutar hesaplanır
        const paymentAmountPerInterval = sumAmountToPay / paymentInterval;

        // Parametreler objesi oluşturulur
        const params = {
          creditname,
          credittext,
          creditdescription,
          creditamount,
          creditinterest,
          creditexpirationmonth,
          creditinstallmentmonth,
          interestCalculated,
          sumAmountToPay,
          paymentInterval,
          paymentAmountPerInterval,
        };
        
        // URL parametreleri oluşturulur
        const urlParams = new URLSearchParams(params);
        const url = `/panel/createcredit?${urlParams}`;

        // Kredi oluşturma isteği gönderilir ve yanıt beklenir
        fetch(url, { method: "post" })
          .then(res => res.json())
          .then(data => {
            // Yanıt kontrol edilir ve başarılı bir şekilde oluşturulduğunda bildirim gösterilir ve sayfa yenilenir
            if (data.msg === "CREDIT-HAS-BEEN-CREATED") {
              alert("NEW CREDIT HAS BEEN CREATED");
              location.reload();
            } else {
              alert(`AN ERROR OCCURRED THEN ${data.msg}`);
            }
          })
          .catch(err => console.log(`[AN ERROR OCCURRED CREATING CREDIT] ${err}`));
      } else {
        throw new Error("Enter another month");
      }
    } catch (err) {
      // Hata türüne göre kullanıcıya uygun bildirim gösterilir
      if (err instanceof TypeError) {
        alert("PLEASE ENTER A VALID VALUE");
      } else {
        alert("AN ERROR OCCURRED: " + err.message);
      }
    }
  });

  // Kredi oluşturma formunu sıfırlama olayını dinleriz
  createCreditForm.addEventListener("reset", () => {
    // Kredi oluşturma formunun görünürlüğünü değiştiririz
    if (createCreditDiv.classList.contains("noVisible")) {
      createCreditDiv.classList.remove("noVisible");
      createCreditDiv.classList.add("visible");
    } else {
      createCreditDiv.classList.remove("visible");
      createCreditDiv.classList.add("noVisible");
    }
  });
</script>


    <!-- MONEY TRANSFER DATA -->

    <script>
      const transfer = document.getElementById("transferPlace")
      const form = document.getElementById("searchForm2")
      const infomoney = document.getElementById("infomoney")
      fetch("/api/adminmoneyhistory", {method: "post"})
      .then(res => res.json())
      .then(data => {
        // console.log(data)
        if(data.length > 0){
           data.forEach((item, i) => {
          transfer.innerHTML += `
          <div class="col-lg-4 mt-5">
                  <ul style="position: relative;">
                    <span style="position: absolute; left: 10px;">${i + 1}.</span>
                    <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                    <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                    <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                    <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                    <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                  </ul>

                  <ul>
                    <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                    <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                    <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                    <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                  </ul>
                  
                  <ul>
                    <li><span style="font-weight: 600;">PROCESS ID: </span><span>${item._id}</span></li>
                    <li><span style="font-weight: 600;">PROCESS: </span><span>User named ${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                    <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                  </ul>
                </div>
          `
          
          
        })
        }
        else{
          transfer.innerHTML = `<h1>NO DATA FOUND</h1>`
        }
       
        let type = ""
        infomoney.addEventListener("change", (e) => {
          type = e.target.value
          // console.log(type)
        })
        form.addEventListener("submit", (e) => {
          e.preventDefault()
          transfer.innerHTML = ""
          const searchmoney = document.getElementById("searchmoney").value

          if(searchmoney === ""){
            data.forEach((item, i) => {
              transfer.innerHTML += `
            <div class="col-lg-4 mt-5">
                    <ul style="position: relative;">
                      <span style="position: absolute; left: 10px;">${i + 1}.</span>
                      <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                      <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                      <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                      <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                    </ul>

                    <ul>
                      <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                    </ul>
                    
                    <ul>
                      <li><span style="font-weight: 600;">PROCESS ID: </span><span>${item._id}</span></li>
                      <li><span style="font-weight: 600;">PROCESS: </span><span>User named ${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                    </ul>
                  </div>
                `
      
              })
          }
          else{
            if(type === "") {
            type = "senderid"
            }
            if(type === "senderid"){
              const filtered = data.filter(item => item.sender.id === searchmoney)
              // console.log(filtered)
              if(filtered.length === 0){
                transfer.innerHTML = `<h1>NO DATA FOUND</h1>`
              }
              else{
                filtered.forEach((item, i) => {
                  transfer.innerHTML +=  
                  `<div class="col-lg-4 mt-5">
                    <ul style="position: relative;">
                      <span style="position: absolute; left: 10px;">${i + 1}.</span>
                      <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                      <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                      <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                      <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                    </ul>

                    <ul>
                      <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                    </ul>
                    
                    <ul>
                      <li><span style="font-weight: 600;">PROCESS ID: </span><span>${item._id}</span></li>
                      <li><span style="font-weight: 600;">PROCESS: </span><span>User named ${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                    </ul>
                  </div>
                `
                })

              }
            }
            else if(type === "receiverid"){
              const filtered = data.filter(item => item.receiver.id === searchmoney)
              if(filtered.length === 0){
                transfer.innerHTML = `<h1>NO DATA FOUND</h1>`
              }
              else{
                filtered.forEach((item, i) => {
                  transfer.innerHTML +=  
                  `<div class="col-lg-4 mt-5">
                    <ul style="position: relative;">
                      <span style="position: absolute; left: 10px;">${i + 1}.</span>
                      <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                      <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                      <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                      <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                    </ul>

                    <ul>
                      <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                    </ul>
                    
                    <ul>
                      <li><span style="font-weight: 600;">PROCESS ID: </span><span>${item._id}</span></li>
                      <li><span style="font-weight: 600;">PROCESS: </span><span>User named ${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                    </ul>
                  </div>
                `
                })
              }
            }
            else if(type === "processid"){
              const filtered = data.filter(item => item._id === searchmoney)
              if(filtered.length < 0){
                transfer.innerHTML = `<h1>NO DATA FOUND</h1>`
              }
              else{
                filtered.forEach((item, i) => {
                  transfer.innerHTML +=  
                  `<div class="col-lg-4 mt-5">
                    <ul style="position: relative;">
                      <span style="position: absolute; left: 10px;">${i + 1}.</span>
                      <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                      <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                      <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                      <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                    </ul>

                    <ul>
                      <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                    </ul>
                    
                    <ul>
                      <li><span style="font-weight: 600;">PROCESS ID: </span><span>User named ${item._id}</span></li>
                      <li><span style="font-weight: 600;">PROCESS: </span><span>${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                    </ul>
                  </div>
                `
                })
              }
            }
            else if(type === "sendername"){
              let search = []
              let filtered = ""
              if(searchmoney.includes(" ")){
                search = searchmoney.split(" ")
                filtered = data.filter(item => item.sender.name.toLowerCase() === search[0].toLowerCase() && item.sender.surname.toLowerCase() === search[1].toLowerCase())
              }
              else{
                filtered = data.filter(item => item.sender.name.toLowerCase() === searchmoney.toLowerCase() || item.sender.surname.toLowerCase() === searchmoney.toLowerCase())
              }
              if(filtered.length === 0){
                transfer.innerHTML = `<h1>NO DATA FOUND</h1>`
              }
              else{
                filtered.forEach((item, i) => {
                  transfer.innerHTML +=  
                  `<div class="col-lg-4 mt-5">
                    <ul style="position: relative;">
                      <span style="position: absolute; left: 10px;">${i + 1}.</span>
                      <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                      <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                      <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                      <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                    </ul>

                    <ul>
                      <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                    </ul>
                    
                    <ul>
                      <li><span style="font-weight: 600;">PROCESS ID: </span><span>User named ${item._id}</span></li>
                      <li><span style="font-weight: 600;">PROCESS: </span><span>User named ${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                    </ul>
                  </div>
                `
                })
              }
            }
            else if(type === "receivername"){
              let search = []
              let filtered = ""
              if(searchmoney.includes(" ")){
                search = searchmoney.split(" ")
                filtered = data.filter(item => item.receiver.name.toLowerCase() === search[0].toLowerCase() && item.receiver.surname.toLowerCase() === search[1].toLowerCase())
              }
              else{
                filtered = data.filter(item => item.receiver.name.toLowerCase() === searchmoney.toLowerCase() || item.receiver.surname.toLowerCase() === searchmoney.toLowerCase())
              }

              if(filtered.length === 0){
                transfer.innerHTML = `<h1>NO DATA FOUND</h1>`
              }
              else{
                filtered.forEach((item, i) => {
                  transfer.innerHTML +=  
                  `<div class="col-lg-4 mt-5">
                    <ul style="position: relative;">
                      <span style="position: absolute; left: 10px;">${i + 1}.</span>
                      <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                      <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                      <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                      <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                    </ul>

                    <ul>
                      <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                      <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                    </ul>
                    
                    <ul>
                      <li><span style="font-weight: 600;">PROCESS ID: </span><span>User named ${item._id}</span></li>
                      <li><span style="font-weight: 600;">PROCESS: </span><span>User named ${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                      <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                    </ul>
                  </div>
                `
                })
              }
            }
          }
          
        })

        form.addEventListener("reset", (e)=> {
          transfer.innerHTML = ""
          if(data.length > 0){
           data.forEach((item, i) => {
          transfer.innerHTML += `
          <div class="col-lg-4 mt-5">
                  <ul style="position: relative;">
                    <span style="position: absolute; left: 10px;">${i + 1}.</span>
                    <li><span style="font-weight: 600;">SENDER ID: </span><span> ${item.sender.id}</span></li>
                    <li><span style="font-weight: 600;">SENDER NAME: </span><span>${item.sender.name} ${item.sender.surname}</span></li>
                    <li><span style="font-weight: 600;">AMOUNT: </span><span>${item.sender.amount.$numberDecimal}</span></li>
                    <li><span style="font-weight: 600;">SENDER OLD BALANCE: ${item.sender.oldmoney.$numberDecimal}</span><span>6.00</span></li>
                    <li><span style="font-weight: 600;">SENDER NEW BALANCE: ${item.sender.newmoney.$numberDecimal}</span><span>1.00</span></li>
                  </ul>

                  <ul>
                    <li><span style="font-weight: 600;">RECEIVER ID: </span><span>${item.receiver.id}</span></li>
                    <li><span style="font-weight: 600;">RECEIVER NAME: </span><span>${item.receiver.name} ${item.receiver.surname}</span></li>
                    <li><span style="font-weight: 600;">RECEIVER OLD BALANCE: </span><span>${item.receiver.oldmoney.$numberDecimal}</span></li>
                    <li><span style="font-weight: 600;">RECEIVER NEW BALANCE: </span><span>${item.receiver.newmoney.$numberDecimal}</span></li>
                  </ul>
                  
                  <ul>
                    <li><span style="font-weight: 600;">PROCESS ID: </span><span>${item._id}</span></li>
                    <li><span style="font-weight: 600;">PROCESS: </span><span>User named ${item.sender.name} ${item.sender.surname} sent ${item.sender.amount.$numberDecimal} money to ${item.receiver.name} ${item.receiver.surname}</span></li>
                    <li><span style="font-weight: 600;">DATE: </span><span>${item.createdAt}</span></li>
                  </ul>
                </div>
          `
          
          
        })
        }
        })
      })
      .catch(err => console.log(`[MONEY HISTORY ERROR] ${err}`))
    </script>

    <!-- APPLICATION ACCEPT & REJECT -->

    <script>
      // İlgili HTML elementini seçiyoruz
      const applicationsHTML = document.getElementById("applications");
    
      // Sunucudan verileri almak için bir POST isteği yapıyoruz
      fetch("/api/adminapplicationslist", {
        method: "post",
      })
        .then((res) => res.json()) // Gelen yanıtı JSON formatına dönüştürüyoruz
        .then((data) => {
          // Gelen veriler üzerinde sıralama yapılıyor
    
          // cardApplicationData dizisi üzerinde userID'ye göre sıralama yapılıyor
          data.cardApplicationData.sort((a, b) => {
            const id1 = a.userID;
            const id2 = b.userID;
    
            if (id1 < id2) {
              return -1;
            }
    
            if (id1 > id2) {
              return 1;
            }
    
            return 0;
          });
    
          // balances dizisi üzerinde userID'ye göre sıralama yapılıyor
          data.balances.sort((a, b) => {
            const id1 = a.userID;
            const id2 = b.userID;
    
            if (id1 < id2) {
              return -1;
            }
    
            if (id1 > id2) {
              return 1;
            }
    
            return 0;
          });
    
          // users dizisi üzerinde _id'ye göre sıralama yapılıyor
          data.users.sort((a, b) => {
            const id1 = a._id;
            const id2 = b._id;
    
            if (id1 < id2) {
              return -1;
            }
    
            if (id1 > id2) {
              return 1;
            }
    
            return 0;
          });
    
          const allusers = [];
          const allbalances = [];
    
          // Her kullanıcı için birden fazla bilgi alınıyor
          const hasMultipleUsers = (userID) => {
            const info = data.users.filter((item) => item._id === userID);
            allusers.push(info);
          };
    
          // Her kullanıcı için birden fazla bakiye bilgisi alınıyor
          const hasMultipleBalances = (userID) => {
            const info = data.balances.filter((item) => item.userID === userID);
            allbalances.push(info);
          };
    
          // cardApplicationData dizisindeki her bir öğe için bilgiler alınıyor
          data.cardApplicationData.forEach((item, i) => {
            hasMultipleUsers(item.userID);
            hasMultipleBalances(item.userID);
          });
    
          data.cardApplicationData.forEach((item, i) => {
            // HTML'e dinamik olarak içerik ekleniyor
            applicationsHTML.innerHTML += `
            <div class="col-lg-4">
              <ul class="mt-3">
                <li>APPLICATION ID : ${item._id}</li>
                <li>USER ID : ${item.userID}</li>
                <li>USER NAME : ${allusers[i][0].name} ${allusers[i][0].surname}</li>
                <li>USER BALANCE : ${allbalances[i][0].balance.$numberDecimal}</li>
                <li>CARD TYPE : ${item.cardInfos.cardType[0].toUpperCase() + item.cardInfos.cardType.slice(1)}</li>
                <li>CARD NAME : ${item.cardInfos.cardName}</li>
                <li>LIMIT : ${item.cardInfos.limit.$numberDecimal}</li>
                <li class="d-flex">
                  <button class="btn btn-success my-2 mr-3" onclick="updateStatus('${item._id}', 'accepted')">Accept</button>
                  <button class="btn btn-danger my-2 mx-3" onclick="updateStatus('${item._id}', 'cancelled')">Cancel</button>
                </li>
              </ul>
            </div>
            `;
          });
        })
        .catch((err) => console.log(err));
    
      // Durumu güncelleme işlemi
      const updateStatus = (id, isAccepted) => {
        const confirmed = confirm("Are you sure?");
        if (confirmed) {
          const params = { id, isAccepted };
          const urlparams = new URLSearchParams(params);
          const url = "/panel/applicationupdate?" + urlparams;
    
          // Sunucuya güncelleme isteği gönderiliyor
          fetch(url, {
            method: "post",
          })
            .then((res) => res.json()) // Gelen yanıtı JSON formatına dönüştürüyoruz
            .then(({ msg }) => {
              if (msg === "cancelled") {
                alert("Successfully Cancelled");
                location.reload();
              } else if (msg === "accepted") {
                alert("Successfully Accepted");
                location.reload();
              } else {
                throw new Error(msg);
              }
            })
            .catch((err) => {
              console.log(err);
              alert("An error occurred " + err);
              // location.reload();
            });
        }
      };
    </script>
    
    <!--HISTORY-->

    <script>
      const historyDatas = document.getElementById("historyDatas");
      const historySearchDatas = document.getElementById("historySearchDatas");
      const searchForm = document.getElementById("searchForm");
      const typesSelect = document.getElementById("typesSel");
      const infosSelect = document.getElementById("infosSel");
      const searchProcess = document.getElementById("searchProcess");

      fetch("/api/adminprocesshistory", {
        method: "post",
      })
        .then((res) => res.json())
        .then((data) => {
          if(data.length > 0){
            data.forEach((item) => {
            let html = `<ul class="${item.processType}"
                            style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                            <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                            <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                            <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                            <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

            if (item.processType === "updating") {
              html += `<li>
                            Updated Datas:
                            <span style="font-weight: 550;">${JSON.stringify(
                              item.updatedInformations
                            )}</span>
                        </li>`;
            }

            html += `</ul>`;
            historyDatas.innerHTML += html;
          });

          let type = "all";
          let info = "adminid";
          typesSelect.addEventListener("change", (e) => {
            type = e.target.value;
          });
          infosSelect.addEventListener("change", (e) => {
            info = e.target.value;
          });

          searchForm.addEventListener("submit", (e) => {
            e.preventDefault();
            const prompt = searchProcess.value;
            // console.log(`[PROMT] ${prompt}`);
            // console.log(`[TYPE] ${type}`);
            // console.log(`[INFO] ${info}`);

            historyDatas.innerHTML = "";
            if (prompt === "") {
              // console.log(`[NO PROMPT]`);
              if (type == "all") {
                data.forEach((item) => {
                  let html = `<ul class="${item.processType}"
                            style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                            <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                            <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                            <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                            <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                  if (item.processType === "updating") {
                    html += `<li>
                            Updated Datas:
                            <span style="font-weight: 550;">${JSON.stringify(
                              item.updatedInformations
                            )}</span>
                        </li>`;
                  }

                  html += `</ul>`;
                  historyDatas.innerHTML += html;
                });
              }
              else if(type === "cardapplication"){
                const filtered = data.filter(item => item.processType === "card-application-accepted" || item.processType === "card-application-cancelled")
                filtered.forEach(item => {
                  let html = `<ul class="${item.processType}"
                            style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                            <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                            <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                            <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                            <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                            </ul>`
                  historyDatas.innerHTML += html;
                })
                
              }
              else if(type === "creditapplication"){
                const filtered = data.filter(item => item.processType === "credit-application-accepted" || item.processType === "credit-application-cancelled")
                filtered.forEach(item => {
                  let html = `<ul class="${item.processType}"
                            style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                            <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                            <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                            <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                            <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                            </ul>`
                  historyDatas.innerHTML += html;
                })
                
              }
              else {
                const filtered = data.filter((item) => item.processType === type);
                filtered.forEach((item) => {
                  let html = `<ul class="${item.processType}"
                            style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                            <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                            <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                            <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                            <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                  if (item.processType === "updating") {
                    html += `<li>
                            Updated Datas:
                            <span style="font-weight: 550;">${JSON.stringify(
                              item.updatedInformations
                            )}</span>
                        </li>`;
                  }

                  html += `</ul>`;
                  historyDatas.innerHTML += html;
                });
              }
            } 
            
            else if (info === "adminid") {
              if (type === "all") {
                const find = data.filter((item) => item.admin.id === prompt);
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              } 

              else if(type === "cardapplication"){
              const find = data.filter(item => item.admin.id === prompt && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"))
              if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                        </ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }

              else if(type === "creditapplication"){
              const find = data.filter(item => item.admin.id === prompt && (item.processType === "credit-application-accepted" || item.processType === "credit-application-cancelled"))
              if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                        </ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }

              else {
                const find = data.filter((item) => item.admin.id === prompt && item.processType === type
                );
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }
            } 
            
            else if (info === "userid") {
              if (type === "all") {
                const find = data.filter((item) => item.user.id === prompt);
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }

              else if(type === "cardapplication"){
              const find = data.filter(item => item.user.id === prompt && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"))
              if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                        </ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }

              else if(type === "creditapplication"){
              const find = data.filter(item => item.user.id === prompt && (item.processType === "credit-application-accepted" || item.processType === "credit-application-cancelled"))
              if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                        </ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }

              else {
                const find = data.filter(
                  (item) => item.user.id === prompt && item.processType === type
                );
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }
            } 
            
            else if (info === "processid") {
              
              const find = data.filter((item) => item._id === prompt);
              if (find.length > 0) {
                find.forEach((item) => {
                  let html = `<ul class="${item.processType}"
                            style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                            <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                            <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                            <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                            <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                  if (item.processType === "updating") {
                    html += `<li>
                            Updated Datas:
                            <span style="font-weight: 550;">${JSON.stringify(
                              item.updatedInformations
                            )}</span>
                        </li>`;
                  }

                  html += `</ul>`;
                  historyDatas.innerHTML += html;
                });
              } 
              else {
                historyDatas.innerHTML += `<h1>NO DATA FOUND</h1>`;
              }
            } 
            
            else if (info === "adminname") {
              let find = []
              if(prompt.includes(" ")){
                const newPromt = prompt.split(" ")
                find = data.filter(item => item.admin.name.toLowerCase() === newPromt[0].toLowerCase() && item.admin.surname.toLowerCase() === newPromt[1].toLowerCase() )
              }
              else{
                find = data.filter((item) =>item.admin.name.toLowerCase() === prompt.toLowerCase() || item.admin.surname.toLowerCase() === prompt.toLowerCase());
              }
              if (type === "all") {
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } 
                else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              } 
              else if(type === "cardapplication"){
                if(prompt.includes(" ")){
                  const newPromt = prompt.split(" ")
                  find = data.filter(item => (item.admin.name.toLowerCase() === newPromt[0].toLowerCase() && item.admin.surname.toLowerCase() === newPromt[1].toLowerCase()) && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled") )
                }
                else{
                  find = data.filter((item) =>(item.admin.name.toLowerCase() === prompt.toLowerCase() || item.admin.surname.toLowerCase() === prompt.toLowerCase()) && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"));
                }
                // find = data.filter(item => item.admin.name.toLowerCase() === prompt.toLowerCase() && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"))
                if (find.length > 0) {
                    find.forEach((item) => {
                      let html = `<ul class="${item.processType}"
                                          style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                          <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                          <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                          <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                          <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                          </ul>`;
                      historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }

              else if(type === "creditapplication"){
                if(prompt.includes(" ")){
                  const newPromt = prompt.split(" ")
                  find = data.filter(item => (item.admin.name.toLowerCase() === newPromt[0].toLowerCase() && item.admin.surname.toLowerCase() === newPromt[1].toLowerCase()) && (item.processType === "credit-application-accepted" || item.processType === "credit-application-cancelled") )
                }
                else{
                  find = data.filter((item) =>(item.admin.name.toLowerCase() === prompt.toLowerCase() || item.admin.surname.toLowerCase() === prompt.toLowerCase()) && (item.processType === "credit-application-accepted" || item.processType === "credit-application-cancelled"));
                }
                // find = data.filter(item => item.admin.name.toLowerCase() === prompt.toLowerCase() && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"))
                if (find.length > 0) {
                    find.forEach((item) => {
                      let html = `<ul class="${item.processType}"
                                          style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                          <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                          <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                          <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                          <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                          </ul>`;
                      historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }

              else {
                if(prompt.includes(" ")){
                const newPromt = prompt.split(" ")
                find = data.filter(item => (item.admin.name.toLowerCase() === newPromt[0].toLowerCase() && item.admin.surname.toLowerCase() === newPromt[1].toLowerCase()) && item.processType === type )
              }
              else{
                find = data.filter((item) =>(item.admin.name.toLowerCase() === prompt.toLowerCase() || item.admin.surname.toLowerCase() === prompt.toLowerCase()) && item.processType === type);
              }
                // find = data.filter((item) => item.admin.name.toLowerCase() === prompt.toLowerCase() && item.processType === type);
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } 
                else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }
            } 
            
            else if (info === "username") {
             
              let find = []
              
              if (type === "all") {
                  if(prompt.includes(" ")){
                    const newPromt = prompt.split(" ")
                    find = data.filter(item => item.user.name.toLowerCase() === newPromt[0].toLowerCase() && item.user.surname.toLowerCase() === newPromt[1].toLowerCase() )
                }
                else{
                  find = data.filter((item) =>item.user.name.toLowerCase() === prompt.toLowerCase() || item.user.surname.toLowerCase() === prompt.toLowerCase());
                }
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } 
                else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              } 
              
              else if(type === "cardapplication"){
                if(prompt.includes(" ")){
                  const newPromt = prompt.split(" ")
                  find = data.filter(item => (item.user.name.toLowerCase() === newPromt[0].toLowerCase() && item.user.surname.toLowerCase() === newPromt[1].toLowerCase()) && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled") )
                }
                else{
                  find = data.filter((item) =>(item.user.name.toLowerCase() === prompt.toLowerCase() || item.user.surname.toLowerCase() === prompt.toLowerCase()) && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"));
                }
                // find = data.filter(item => item.admin.name.toLowerCase() === prompt.toLowerCase() && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"))
                if (find.length > 0) {
                    find.forEach((item) => {
                      let html = `<ul class="${item.processType}"
                                          style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                          <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                          <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                          <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                          <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                          </ul>`;
                      historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }
              
              else if(type === "creditapplication"){
                if(prompt.includes(" ")){
                  const newPromt = prompt.split(" ")
                  find = data.filter(item => (item.user.name.toLowerCase() === newPromt[0].toLowerCase() && item.user.surname.toLowerCase() === newPromt[1].toLowerCase()) && (item.processType === "credit-application-accepted" || item.processType === "credit-application-cancelled") )
                }
                else{
                  find = data.filter((item) =>(item.user.name.toLowerCase() === prompt.toLowerCase() || item.user.surname.toLowerCase() === prompt.toLowerCase()) && (item.processType === "credit-application-accepted" || item.processType === "credit-application-cancelled"));
                }
                // find = data.filter(item => item.admin.name.toLowerCase() === prompt.toLowerCase() && (item.processType === "card-application-accepted" || item.processType === "card-application-cancelled"))
                if (find.length > 0) {
                    find.forEach((item) => {
                      let html = `<ul class="${item.processType}"
                                          style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                          <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                          <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                          <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                          <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>
                                          </ul>`;
                      historyDatas.innerHTML += html;
                  });
                } else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }
              }
              
              else {
                if(prompt.includes(" ")){
                const newPromt = prompt.split(" ")
                find = data.filter(item => (item.user.name.toLowerCase() === newPromt[0].toLowerCase() && item.user.surname.toLowerCase() === newPromt[1].toLowerCase()) && item.processType === type )
              }
              else{
                find = data.filter((item) =>(item.user.name.toLowerCase() === prompt.toLowerCase() || item.user.surname.toLowerCase() === prompt.toLowerCase()) && item.processType === type);
              }
                // find = data.filter((item) => item.admin.name.toLowerCase() === prompt.toLowerCase() && item.processType === type);
                if (find.length > 0) {
                  find.forEach((item) => {
                    let html = `<ul class="${item.processType}"
                                         style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                                        <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                                        <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                                        <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                                        <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

                    if (item.processType === "updating") {
                      html += `<li>
                                        Updated Datas:
                                        <span style="font-weight: 550;">${JSON.stringify(
                                          item.updatedInformations
                                        )}</span>
                                    </li>`;
                    }

                    html += `</ul>`;
                    historyDatas.innerHTML += html;
                  });
                } 
                else {
                  historyDatas.innerHTML = `<h1>NO DATA FOUND</h1>`;
                }


            }
            }
          });

          searchForm.addEventListener("reset", (e) => {
            historyDatas.innerHTML = "";
            data.forEach((item) => {
              // console.log(`[RESET]`);
              let html = `<ul class="${item.processType}"
                            style="border-top: 1px solid black; border-bottom: 1px solid black; padding: 30px 0;">
                            <li>Process ID: <span style="font-weight: 550;">${item._id}</span></li>
                            <li>Type: <span style="font-weight: 550;">${item.processType}</span></li>
                            <li>Process: <span style="font-weight: 550;">${item.process}</span></li>
                            <li>Process Date: <span style="font-weight: 550;">${item.processDate}</span></li>`;

              if (item.processType === "updating") {
                html += `<li>
                            Updated Datas:
                            <span style="font-weight: 550;">${JSON.stringify(
                              item.updatedInformations
                            )}</span>
                        </li>`;
              }

              html += `</ul>`;
              historyDatas.innerHTML += html;
            });
          });
          
          }
          else{
            historyDatas.innerHTML += `<h1>NO DATA FOUND</h1>`
          } 
        })
        .catch((err) =>
          console.log(`[AN ERROR OCCURRED ON ADMIN PROCESS HISTORY]`)
        );
    </script>

    <!--ADMIN-->
    <script>
      const del = (id) => {
        const confirmed = confirm("Are you sure?");
        if (confirmed) {
          const params = { id };
          const urlParams = new URLSearchParams(params);
          const url = `/panel/deleteuser?${urlParams}`;
          fetch(url, {
            method: "DELETE",
          })
            .then((res) => res.json())
            .then((data) => {
              if (data.msg == "deleted") {
                alert("Successfully Deleted");
                location.reload();
              } else if (data.msg == "notDeleted") {
                alert("You can't delete");
              }
            })
            .catch((err) => console.log(`[${url} ERROR] ${err}`));
        }
      };

      const update = (id) => {
  // HTML formunu seçiyoruz
  const updateForm = document.getElementById("userForm");

  if (updateForm.classList.contains("userFormND")) {
    // Forma "userFormYD" sınıfını ekliyoruz ve "userFormND" sınıfını kaldırıyoruz
    updateForm.classList.remove("userFormND");
    updateForm.classList.add("userFormYD");

    // Form gönderildiğinde çalışacak olan olay dinleyicisini ekliyoruz
    updateForm.addEventListener("submit", (event) => {
      event.preventDefault();

      // Formdaki alan değerlerini alıyoruz
      const name = [document.getElementById("name").value, "name"];
      const surname = [document.getElementById("surname").value, "surname"];
      const birthdate = [document.getElementById("birthdate").value, "birthdate"];
      
      // Seçilen cinsiyet değerini alıyoruz
      const selectedGender = document.querySelector('input[name="gender"]:checked');
      let gender = [];
      if (selectedGender) {
        gender = [selectedGender.value, "gender"];
      }
      
      // Seçilen yetkilendirme değerini alıyoruz
      const selectedAuth = document.querySelector('input[name="auth"]:checked');
      let auth = [];
      if (selectedAuth) {
        auth = [selectedAuth.value, "authorization"];
      }
      
      const email = [document.getElementById("email").value, "email"];
      const identityNumber = [document.getElementById("identityNumber").value, "identityNumber"];
      const tel = [document.getElementById("tel").value, "tel"];
      const password = [document.getElementById("password").value, "password"];
      
      // Adres bilgilerini alıyoruz
      const address = [
        [document.getElementById("street").value, "street"],
        [document.getElementById("district").value, "district"],
        [document.getElementById("city").value, "city"],
        [document.getElementById("country").value, "country"],
      ];
      
      const iban = [document.getElementById("iban").value, "iban"];
      const balance = [document.getElementById("balance").value, "balance"];
      
      // Tüm verileri bir dizi içinde topluyoruz
      let data = [
        name,
        surname,
        birthdate,
        email,
        identityNumber,
        tel,
        password,
        iban,
        balance,
      ];
      
      // Cinsiyet verisi doluysa, dataya ekliyoruz
      if (gender != "" || gender != undefined || gender != null) {
        data.push(gender);
      }
      
      // Yetkilendirme verisi doluysa, dataya ekliyoruz
      if (auth != "" || auth != undefined || auth != null) {
        data.push(auth);
      }

      // Adres bilgilerinden boş olanları filtreliyoruz
      const filteredAddress = address.filter((item) => item[0] !== "");

      // Verilerden boş olanları ve belirli alanları filtreliyoruz
      const filteredData = data.filter(
        (item) =>
          item[0] !== "" ||
          (item[0] !== "" && item[1] === "birthdate") ||
          (item[0] !== "" && item[1] === "gender") ||
          (item[0] !== "" && item[1] === "email")
      );

      let params = {};
      
      // Adres bilgisi varsa, adres parametrelerini JSON formatına dönüştürerek ekliyoruz
      if (filteredAddress.length > 0) {
        const addressParams = JSON.stringify(
          Object.fromEntries(
            filteredAddress.map((item) => [item[1], item[0]])
          )
        );
        
        // Diğer verileri ve adresi birleştiriyoruz
        params = {
          id,
          ...Object.fromEntries(
            filteredData.map((item) => [item[1], item[0]])
          ),
          address: addressParams,
        };
      } else {
        // Adres bilgisi yoksa, sadece diğer verileri ekliyoruz
        params = {
          id,
          ...Object.fromEntries(
            filteredData.map((item) => [item[1], item[0]])
          ),
        };
      }

      // Parametreleri URL kodlamasına uygun bir şekilde dönüştürüyoruz
      const urlParams = new URLSearchParams(params);
      const url = `/panel/updateuser?${urlParams}`;

      // Güncelleme isteğini sunucuya gönderiyoruz
      fetch(url, {
        method: "post",
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((res) => res.json())
        .then((data) => {
          // Sunucudan gelen yanıta göre işlem yapılıyor
          if (data.msg == "updated") {
            alert("Successfully Updated");
            location.reload();
          } else if (data.msg == "notUpdated") {
            alert("You can't update");
            location.reload();
          } else if (data.msg == "dataBaseError") {
            alert("There is a same value");
            location.reload();
          } 
           else if (data.msg == "authError") {
            alert("You can't update an users authorization");
            location.reload();
          } else{
            alert("An Error Occurred: "+ data.error);
            location.reload();
          }
        })
        .catch((err) => console.log(`[${url} ERROR] ${err}`));

      // Forma "userFormYD" sınıfını kaldırıyoruz ve "userFormND" sınıfını ekliyoruz
      updateForm.classList.remove("userFormYD");
      updateForm.classList.add("userFormND");
    });
  } else {
    // Sayfayı yeniden yüklüyoruz
    location.reload();
  }
};

      const addNewOwner = () => {
        const updateForm = document.getElementById("addOwnerForm");
        if (updateForm.classList.contains("userFormND")) {
          updateForm.classList.remove("userFormND");
          updateForm.classList.add("userFormYD");

          updateForm.addEventListener("submit", (e) => {
            e.preventDefault();

            const name = document.getElementById("nameOwner").value;
            const surname = document.getElementById("surnameOwner").value;
            const birthDate = document.getElementById("birthdateOwner").value;
            const email = document.getElementById("emailOwner").value;
            const gender = document.querySelector(
              'input[name="gender"]:checked'
            ).value;
            const password = document.getElementById("passwordOwner").value;
            const identityNumber = document.getElementById(
              "identityNumberOwner"
            ).value;
            const tel = document.getElementById("telOwner").value;
            const street = document.getElementById("streetOwner").value;
            const district = document.getElementById("districtOwner").value;
            const city = document.getElementById("cityOwner").value;
            const country = document.getElementById("countryOwner").value;

            const params = {
              name,
              surname,
              birthDate,
              email,
              password,
              gender,
              identityNumber,
              tel,
              street,
              district,
              city,
              country,
              authorization: "owner",
            };
            const urlParams = new URLSearchParams(params);
            const url = `/panel/adduser?${urlParams}`;
            fetch(url, {
              method: "post",
            })
              .then((res) => res.json())
              .then((data) => {
                if (data.msg == "added") {
                  alert("NEW OWNER ADDED");
                  location.reload();
                } else {
                  alert(data.msg);
                }
              })
              .catch((err) => {});
          });
        } else {
          updateForm.classList.add("userFormND");
          updateForm.classList.remove("userFormYD");
        }
      };

      const addNewAdmin = () => {
        const updateForm = document.getElementById("addAdminForm");
        if (updateForm.classList.contains("userFormND")) {
          updateForm.classList.remove("userFormND");
          updateForm.classList.add("userFormYD");

          updateForm.addEventListener("submit", (e) => {
            e.preventDefault();

            const name = document.getElementById("nameAdmin").value;
            const surname = document.getElementById("surnameAdmin").value;
            const birthDate = document.getElementById("birthdateAdmin").value;
            const email = document.getElementById("emailAdmin").value;
            const gender = document.querySelector(
              'input[name="genderAdmin"]:checked'
            ).value;
            const password = document.getElementById("passwordAdmin").value;
            const identityNumber = document.getElementById(
              "identityNumberAdmin"
            ).value;
            const tel = document.getElementById("telAdmin").value;
            const street = document.getElementById("streetAdmin").value;
            const district = document.getElementById("districtAdmin").value;
            const city = document.getElementById("cityAdmin").value;
            const country = document.getElementById("countryAdmin").value;

            const params = {
              name,
              surname,
              birthDate,
              email,
              password,
              gender,
              identityNumber,
              tel,
              street,
              district,
              city,
              country,
              authorization: "admin",
            };
            const urlParams = new URLSearchParams(params);
            const url = `/panel/adduser?${urlParams}`;
            fetch(url, {
              method: "post",
            })
              .then((res) => res.json())
              .then((data) => {
                if (data.msg == "added") {
                  alert("NEW ADMIN ADDED");
                  location.reload();
                } else {
                  alert(data.msg);
                }
              })
              .catch((err) => {});
          });
        } else {
          updateForm.classList.add("userFormND");
          updateForm.classList.remove("userFormYD");
        }
      };

      const addNewUser = () => {
        const updateForm = document.getElementById("addUserForm");
        if (updateForm.classList.contains("userFormND")) {
          updateForm.classList.remove("userFormND");
          updateForm.classList.add("userFormYD");

          updateForm.addEventListener("submit", (e) => {
            e.preventDefault();

            const name = document.getElementById("nameUser").value;
            const surname = document.getElementById("surnameUser").value;
            const birthDate = document.getElementById("birthdateUser").value;
            const email = document.getElementById("emailUser").value;
            const gender = document.querySelector(
              'input[name="genderUser"]:checked'
            ).value;
            const password = document.getElementById("passwordUser").value;
            const identityNumber =
              document.getElementById("identityNumberUser").value;
            const tel = document.getElementById("telUser").value;
            const street = document.getElementById("streetUser").value;
            const district = document.getElementById("districtUser").value;
            const city = document.getElementById("cityUser").value;
            const country = document.getElementById("countryUser").value;

            const params = {
              name,
              surname,
              birthDate,
              email,
              password,
              gender,
              identityNumber,
              tel,
              street,
              district,
              city,
              country,
              authorization: "user",
            };
            const urlParams = new URLSearchParams(params);
            const url = `/panel/adduser?${urlParams}`;
            fetch(url, {
              method: "post",
            })
              .then((res) => res.json())
              .then((data) => {
                if (data.msg == "added") {
                  alert("NEW USER ADDED");
                  location.reload();
                } else {
                  alert(data.msg);
                }
              })
              .catch((err) => {});
          });
        } else {
          updateForm.classList.add("userFormND");
          updateForm.classList.remove("userFormYD");
        }
      };
    </script>

    <!--USER DATA-->
    <script>
      const ownerTable = document.getElementById("ownertable");
      const adminTable = document.getElementById("admintable");
      const userTable = document.getElementById("usertable");
      const ownerSearch = document.getElementById("ownerSearch");
      const adminSearch = document.getElementById("adminSearch");
      const userSearch = document.getElementById("userSearch");

      let selOwner = "id"
      let selAdmin = "id"
      let selUser = "id"
      document.getElementById("ownerOpt").addEventListener("change", (e) => {
        selOwner = e.target.value
      })
      document.getElementById("adminOpt").addEventListener("change", (e) => {
        selAdmin = e.target.value
        console.log(selAdmin)
      })
      document.getElementById("userOpt").addEventListener("change", (e) => {
        selUser = e.target.value
        console.log(selUser)
      })


      fetch("/api/users", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then((response) => response.json())
        .then((data) => {
          console.log(data)
          ownerSearch.addEventListener("submit", (e) => {
            e.preventDefault()
            const prompt = document.getElementById("searchOwner").value;
            ownerTable.innerHTML = `
            <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Gender</th>
                      <th>Birth Date</th>
                      <th>Email</th>
                      <th>Identity</th>
                      <th>Tel No</th>
                      <th>Adress</th>
                      <th>IBAN</th>
                      <th>Balance</th>
                      <th>Debts</th>
                      <th>Carts</th>
                      <th>Actions</th>
                    </tr>
            `
            if(prompt != ""){
              let found = []
              let user = []
              switch(selOwner){
                case "id":
                  found = data.users.find(item => item._id === prompt && item.authorization == "owner")
                  if(found != undefined){
                  console.log(found)
                  const user = data.balances.find(balance => balance.userID == found._id)
                  const cards = data.cards.filter(card => card.userID == found._id)
                  ownerTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "name":
                  if(prompt.includes(" ")){
                    const newPromt = prompt.split(" ")
                    console.log(newPromt)
                    found = data.users.filter(item => (item.name.toLowerCase() === newPromt[0].toLowerCase() && item.surname.toLowerCase() === newPromt[1].toLowerCase()) && item.authorization == "owner" )
                  }
                  else{
                    found = data.users.filter((item) =>(item.name.toLowerCase() === prompt.toLowerCase() || item.surname.toLowerCase() === prompt.toLowerCase()) && item.authorization == "owner" );
                  }
                  if(found != [] && found != undefined){
                    found.forEach(item => {
                      const user = data.balances.find(balance => balance.userID == item._id)
                      const cards = data.cards.filter(card => card.userID == item._id)
                      ownerTable.innerHTML += `
                        <tr>
                          <td>${item._id}</td>
                          <td>${item.name} ${item.surname}</td>
                          <td>${item.gender == "male" ? "M" : "F"}</td>
                          <td>${item.birthDate.split("T")[0]}</td>
                          <td>${item.email}</td>
                          <td>${item.identityNumber}</td>
                          <td>${item.tel}</td>
                          <td>${item.address.street} ${item.address.district} ${item.address.city} ${item.address.country}</td>
                          <td>${user.iban}</td>
                          <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                          <td style="min-width: 200px;">
                            ${user.debts.map(item => {
                            const paymentTime = new Date(item.paymentTime);
                            return (
                              `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                            )
                          })}</td>
                          <td style="min-width: 200px;">
                            ${cards.map(item => {
                              return (
                              `[Card Name: ${item.cardInfos.cardName} - 
                              Card Type: ${item.cardInfos.cardType}] 
                              </br>`
                            )
                            })}  
                          </td>
                          <td>
                              <button onclick="del('${item._id}')">Delete</button>
                              <button class="updatebut" onclick="update('${item._id}')">Update</button>
                          </td>
                        </tr>
                        `

                    })
                  }
                  break
                case "email":
                  found = data.users.find(item => item.email === prompt && item.authorization == "owner")
                  if(found != undefined){
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    ownerTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "identity":
                  found = data.users.find(item => item.identityNumber === prompt  && item.authorization === "owner")
                  if(found != undefined){
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    ownerTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "tel":
                  found = data.users.find(item => item.tel === prompt && item.authorization === "owner")
                  if(found != undefined){
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    ownerTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "iban":
                  user = data.balances.find(balance => balance.iban == prompt)               
                  if(user != undefined){
                    found = data.users.find(item => user.userID == item._id  && item.authorization === "owner")
                    const cards = data.cards.filter(card => card.userID == found._id)
                    ownerTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "debt":
                // item.debts.length > 0 &&
                  const debts = data.balances.filter(item => item.debts.length > 0)
                  console.log(debts)
                  // console.log(prompt)
                  // debts.debts.forEach(item => {
                  //   console.log(item.creditname)
                  //   console.log(prompt.toLowerCase())
                  // })
                  if(debts.length > 0){
                    const balances = debts.filter(item => item.debts.find(item => item.creditname.toLowerCase() == prompt.toLowerCase()))
                    console.log(balances)
                    // console.log(balance)
                    if(balances.length > 0){
                      console.log(`[balance LENGTH] ${balances.length}`)
                      balances.forEach(item => {
                        found = data.users.find(f => item.userID == f._id  && f.authorization === "owner")
                        console.log(`[FOUND] ${JSON.stringify(found)}`)
                        if(found != undefined){
                          const cards = data.cards.filter(card => card.userID == found._id)
                          ownerTable.innerHTML += `
                        <tr>
                            <td>${found._id}</td>
                            <td>${found.name} ${found.surname}</td>
                            <td>${found.gender == "male" ? "M" : "F"}</td>
                            <td>${found.birthDate.split("T")[0]}</td>
                            <td>${found.email}</td>
                            <td>${found.identityNumber}</td>
                            <td>${found.tel}</td>
                            <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                            <td>${item.iban}</td>
                            <td>${JSON.stringify(item.balance.$numberDecimal)}</td>
                            <td style="min-width: 200px;">
                              ${item.debts.map(item => {
                              const paymentTime = new Date(item.paymentTime);
                              return (
                                `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                              )
                            })}</td>
                            <td style="min-width: 200px;">
                              ${cards.map(item => {
                                return (
                                `[Card Name: ${item.cardInfos.cardName} - 
                                Card Type: ${item.cardInfos.cardType}] 
                                </br>`
                              )
                              })}  
                            </td>
                            <td>
                                <button onclick="del('${found._id}')">Delete</button>
                                <button class="updatebut" onclick="update('${found._id}')">Update</button>
                            </td>
                        </tr>
                        `
                          
                        }
                      })
                    
                    }
                  }
                  break
              
              }
            }
            else{
              data.users.forEach(item => {
                if(item.authorization === "owner"){
                  const user = data.balances.find(balance => balance.userID == item._id)
                  const cards = data.cards.filter(card => card.userID == item._id)
                  
                  ownerTable.innerHTML += `
                      <tr>
                          <td>${item._id}</td>
                          <td>${item.name} ${item.surname}</td>
                          <td>${item.gender == "male" ? "M" : "F"}</td>
                          <td>${item.birthDate.split("T")[0]}</td>
                          <td>${item.email}</td>
                          <td>${item.identityNumber}</td>
                          <td>${item.tel}</td>
                          <td>${item.address.street} ${item.address.district} ${item.address.city} ${item.address.country}</td>
                          <td>${user.iban}</td>
                          <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                          <td style="min-width: 200px;">
                            ${user.debts.map(item => {
                            const paymentTime = new Date(item.paymentTime);
                            return (
                              `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                            )
                          })}</td>
                          <td style="min-width: 200px;">
                            ${cards.map(item => {
                              return (
                              `[Card Name: ${item.cardInfos.cardName} - 
                              Card Type: ${item.cardInfos.cardType}] 
                              </br>`
                            )
                            })}  
                          </td>
                          <td>
                              <button onclick="del('${item._id}')">Delete</button>
                              <button class="updatebut" onclick="update('${item._id}')">Update</button>
                          </td>
                      </tr>
                      `
                }
              })
            }
         })

          adminSearch.addEventListener("submit", (e) => {
            e.preventDefault()
            const prompt = document.getElementById("searchAdmin").value;
            adminTable.innerHTML = `
            <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Gender</th>
                      <th>Birth Date</th>
                      <th>Email</th>
                      <th>Identity</th>
                      <th>Tel No</th>
                      <th>Adress</th>
                      <th>IBAN</th>
                      <th>Balance</th>
                      <th>Debts</th>
                      <th>Carts</th>
                      <th>Actions</th>
                    </tr>
            `
            if(prompt != ""){
              let found = []
              switch(selAdmin){
                case "id":
                  found = data.users.find(item => item._id === prompt && item.authorization == "admin")
                  if(found != undefined){
                  console.log(found)
                  const user = data.balances.find(balance => balance.userID == found._id)
                  const cards = data.cards.filter(card => card.userID == found._id)
                  adminTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "name":
                  if(prompt.includes(" ")){
                    const newPromt = prompt.split(" ")
                    console.log(newPromt)
                    found = data.users.filter(item => (item.name.toLowerCase() === newPromt[0].toLowerCase() && item.surname.toLowerCase() === newPromt[1].toLowerCase()) && item.authorization == "admin" )
                  }
                  else{
                    found = data.users.filter((item) =>(item.name.toLowerCase() === prompt.toLowerCase() || item.surname.toLowerCase() === prompt.toLowerCase()) && item.authorization == "admin" );
                  }
                  if(found != [] && found != undefined){
                    found.forEach(item => {
                      const user = data.balances.find(balance => balance.userID == item._id)
                      const cards = data.cards.filter(card => card.userID == item._id)
                      adminTable.innerHTML += `
                        <tr>
                          <td>${item._id}</td>
                          <td>${item.name} ${item.surname}</td>
                          <td>${item.gender == "male" ? "M" : "F"}</td>
                          <td>${item.birthDate.split("T")[0]}</td>
                          <td>${item.email}</td>
                          <td>${item.identityNumber}</td>
                          <td>${item.tel}</td>
                          <td>${item.address.street} ${item.address.district} ${item.address.city} ${item.address.country}</td>
                          <td>${user.iban}</td>
                          <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                          <td style="min-width: 200px;">
                            ${user.debts.map(item => {
                            const paymentTime = new Date(item.paymentTime);
                            return (
                              `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                            )
                          })}</td>
                          <td style="min-width: 200px;">
                            ${cards.map(item => {
                              return (
                              `[Card Name: ${item.cardInfos.cardName} - 
                              Card Type: ${item.cardInfos.cardType}] 
                              </br>`
                            )
                            })}  
                          </td>
                          <td>
                              <button onclick="del('${item._id}')">Delete</button>
                              <button class="updatebut" onclick="update('${item._id}')">Update</button>
                          </td>
                        </tr>
                        `

                    })
                  }
                  break
                case "email":
                  found = data.users.find(item => item.email === prompt && item.authorization == "admin")
                  if(found != undefined){
                    console.log(found)
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    adminTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "identity":
                  found = data.users.find(item => item.identityNumber === prompt  && item.authorization === "admin")
                  console.log("found")
                  if(found != undefined){
                    console.log("foun2")
                    console.log(found)
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    adminTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "tel":
                  found = data.users.find(item => item.tel === prompt && item.authorization === "admin")
                  if(found != undefined){
                    console.log(found)
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    adminTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "iban":
                  let user = data.balances.find(balance => balance.iban == prompt)               
                  if(user != undefined){
                    found = data.users.find(item => user.userID == item._id  && item.authorization === "admin")
                      console.log(found)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    adminTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                    }
                  break
                case "debt":
                // item.debts.length > 0 &&
                  const debts = data.balances.filter(item => item.debts.length > 0)
                  console.log(debts)
                  // console.log(prompt)
                  // debts.debts.forEach(item => {
                  //   console.log(item.creditname)
                  //   console.log(prompt.toLowerCase())
                  // })
                  if(debts.length > 0){
                    const balances = debts.filter(item => item.debts.find(item => item.creditname.toLowerCase() == prompt.toLowerCase()))
                    console.log(balances)
                    // console.log(balance)
                    if(balances.length > 0){
                      console.log(`[balance LENGTH] ${balances.length}`)
                      balances.forEach(item => {
                        found = data.users.find(f => item.userID == f._id  && f.authorization === "admin")
                        console.log(`[FOUND] ${JSON.stringify(found)}`)
                        if(found != undefined){
                          const cards = data.cards.filter(card => card.userID == found._id)
                          adminTable.innerHTML += `
                        <tr>
                            <td>${found._id}</td>
                            <td>${found.name} ${found.surname}</td>
                            <td>${found.gender == "male" ? "M" : "F"}</td>
                            <td>${found.birthDate.split("T")[0]}</td>
                            <td>${found.email}</td>
                            <td>${found.identityNumber}</td>
                            <td>${found.tel}</td>
                            <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                            <td>${item.iban}</td>
                            <td>${JSON.stringify(item.balance.$numberDecimal)}</td>
                            <td style="min-width: 200px;">
                              ${item.debts.map(item => {
                              const paymentTime = new Date(item.paymentTime);
                              return (
                                `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                              )
                            })}</td>
                            <td style="min-width: 200px;">
                              ${cards.map(item => {
                                return (
                                `[Card Name: ${item.cardInfos.cardName} - 
                                Card Type: ${item.cardInfos.cardType}] 
                                </br>`
                              )
                              })}  
                            </td>
                            <td>
                                <button onclick="del('${found._id}')">Delete</button>
                                <button class="updatebut" onclick="update('${found._id}')">Update</button>
                            </td>
                        </tr>
                        `
                          
                        }
                      })
                    
                    }
                  }
                  break
              
              }
            }
            else{
              data.users.forEach(item => {
                if(item.authorization == "admin"){
                  console.log(item)
                  const user = data.balances.find(balance => balance.userID == item._id)
                  const cards = data.cards.filter(card => card.userID == item._id)
                  
                  adminTable.innerHTML += `
                      <tr>
                          <td>${item._id}</td>
                          <td>${item.name} ${item.surname}</td>
                          <td>${item.gender == "male" ? "M" : "F"}</td>
                          <td>${item.birthDate.split("T")[0]}</td>
                          <td>${item.email}</td>
                          <td>${item.identityNumber}</td>
                          <td>${item.tel}</td>
                          <td>${item.address.street} ${item.address.district} ${item.address.city} ${item.address.country}</td>
                          <td>${user.iban}</td>
                          <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                          <td style="min-width: 200px;">
                            ${user.debts.map(item => {
                            const paymentTime = new Date(item.paymentTime);
                            return (
                              `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                            )
                          })}</td>
                          <td style="min-width: 200px;">
                            ${cards.map(item => {
                              return (
                              `[Card Name: ${item.cardInfos.cardName} - 
                              Card Type: ${item.cardInfos.cardType}] 
                              </br>`
                            )
                            })}  
                          </td>
                          <td>
                              <button onclick="del('${item._id}')">Delete</button>
                              <button class="updatebut" onclick="update('${item._id}')">Update</button>
                          </td>
                      </tr>
                      `
                }
              })
            }
         })

          userSearch.addEventListener("submit", (e) => {
            e.preventDefault()
            const prompt = document.getElementById("searchUser").value;
            userTable.innerHTML = `
            <tr>
                      <th>ID</th>
                      <th>Name</th>
                      <th>Gender</th>
                      <th>Birth Date</th>
                      <th>Email</th>
                      <th>Identity</th>
                      <th>Tel No</th>
                      <th>Adress</th>
                      <th>IBAN</th>
                      <th>Balance</th>
                      <th>Debts</th>
                      <th>Carts</th>
                      <th>Actions</th>
                    </tr>
            `
            if(prompt != ""){
              let found = []
              switch(selUser){
                case "id":
                  found = data.users.find(item => item._id === prompt && item.authorization == "user")
                  if(found != undefined){
                  console.log(found)
                  const user = data.balances.find(balance => balance.userID == found._id)
                  const cards = data.cards.filter(card => card.userID == found._id)
                  userTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "name":
                  if(prompt.includes(" ")){
                    const newPromt = prompt.split(" ")
                    console.log(newPromt)
                    found = data.users.filter(item => (item.name.toLowerCase() === newPromt[0].toLowerCase() && item.surname.toLowerCase() === newPromt[1].toLowerCase()) && item.authorization == "user" )
                  }
                  else{
                    found = data.users.filter((item) =>(item.name.toLowerCase() === prompt.toLowerCase() || item.surname.toLowerCase() === prompt.toLowerCase()) && item.authorization == "user" );
                  }
                  if(found != [] && found != undefined){
                    found.forEach(item => {
                      const user = data.balances.find(balance => balance.userID == item._id)
                      const cards = data.cards.filter(card => card.userID == item._id)
                      userTable.innerHTML += `
                        <tr>
                          <td>${item._id}</td>
                          <td>${item.name} ${item.surname}</td>
                          <td>${item.gender == "male" ? "M" : "F"}</td>
                          <td>${item.birthDate.split("T")[0]}</td>
                          <td>${item.email}</td>
                          <td>${item.identityNumber}</td>
                          <td>${item.tel}</td>
                          <td>${item.address.street} ${item.address.district} ${item.address.city} ${item.address.country}</td>
                          <td>${user.iban}</td>
                          <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                          <td style="min-width: 200px;">
                            ${user.debts.map(item => {
                            const paymentTime = new Date(item.paymentTime);
                            return (
                              `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                            )
                          })}</td>
                          <td style="min-width: 200px;">
                            ${cards.map(item => {
                              return (
                              `[Card Name: ${item.cardInfos.cardName} - 
                              Card Type: ${item.cardInfos.cardType}] 
                              </br>`
                            )
                            })}  
                          </td>
                          <td>
                              <button onclick="del('${item._id}')">Delete</button>
                              <button class="updatebut" onclick="update('${item._id}')">Update</button>
                          </td>
                        </tr>
                        `

                    })
                  }
                  break
                case "email":
                  found = data.users.find(item => item.email === prompt && item.authorization == "user")
                  if(found != undefined){
                    console.log(found)
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    userTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "identity":
                  found = data.users.find(item => item.identityNumber === prompt  && item.authorization === "user")
                  if(found != undefined){
                    console.log(found)
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    userTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "tel":
                  found = data.users.find(item => item.tel === prompt && item.authorization === "user")
                  if(found != undefined){
                    console.log(found)
                    const user = data.balances.find(balance => balance.userID == found._id)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    userTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                  break
                case "iban":
                  let user = data.balances.find(balance => balance.iban == prompt)               
                  if(user != undefined){
                    found = data.users.find(item => user.userID == item._id  && item.authorization === "user")
                    if(found.authorization == "user"){
                      console.log(found)
                    const cards = data.cards.filter(card => card.userID == found._id)
                    userTable.innerHTML += `
                    <tr>
                        <td>${found._id}</td>
                        <td>${found.name} ${found.surname}</td>
                        <td>${found.gender == "male" ? "M" : "F"}</td>
                        <td>${found.birthDate.split("T")[0]}</td>
                        <td>${found.email}</td>
                        <td>${found.identityNumber}</td>
                        <td>${found.tel}</td>
                        <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${found._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${found._id}')">Update</button>
                        </td>
                    </tr>
                    `
                  }
                    }

                  break
                  case "debt":
                // item.debts.length > 0 &&
                  const debts = data.balances.filter(item => item.debts.length > 0)
                  console.log(debts)
                  // console.log(prompt)
                  // debts.debts.forEach(item => {
                  //   console.log(item.creditname)
                  //   console.log(prompt.toLowerCase())
                  // })
                  if(debts.length > 0){
                    const balances = debts.filter(item => item.debts.find(item => item.creditname.toLowerCase() == prompt.toLowerCase()))
                    console.log(balances)
                    // console.log(balance)
                    if(balances.length > 0){
                      console.log(`[balance LENGTH] ${balances.length}`)
                      balances.forEach(item => {
                        found = data.users.find(f => item.userID == f._id  && f.authorization === "user")
                        console.log(`[FOUND] ${JSON.stringify(found)}`)
                        if(found != undefined){
                          const cards = data.cards.filter(card => card.userID == found._id)
                          userTable.innerHTML += `
                        <tr>
                            <td>${found._id}</td>
                            <td>${found.name} ${found.surname}</td>
                            <td>${found.gender == "male" ? "M" : "F"}</td>
                            <td>${found.birthDate.split("T")[0]}</td>
                            <td>${found.email}</td>
                            <td>${found.identityNumber}</td>
                            <td>${found.tel}</td>
                            <td>${found.address.street} ${found.address.district} ${found.address.city} ${found.address.country}</td>
                            <td>${item.iban}</td>
                            <td>${JSON.stringify(item.balance.$numberDecimal)}</td>
                            <td style="min-width: 200px;">
                              ${item.debts.map(item => {
                              const paymentTime = new Date(item.paymentTime);
                              return (
                                `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                              )
                            })}</td>
                            <td style="min-width: 200px;">
                              ${cards.map(item => {
                                return (
                                `[Card Name: ${item.cardInfos.cardName} - 
                                Card Type: ${item.cardInfos.cardType}] 
                                </br>`
                              )
                              })}  
                            </td>
                            <td>
                                <button onclick="del('${found._id}')">Delete</button>
                                <button class="updatebut" onclick="update('${found._id}')">Update</button>
                            </td>
                        </tr>
                        `
                          
                        }
                      })
                    
                    }
                  }
                  break
              
              
              }
            }
            else{
              data.users.forEach(item => {
                if(item.authorization == "user"){
                  console.log(item)
                  const user = data.balances.find(balance => balance.userID == item._id)
                  const cards = data.cards.filter(card => card.userID == item._id)
                  
                  userTable.innerHTML += `
                      <tr>
                          <td>${item._id}</td>
                          <td>${item.name} ${item.surname}</td>
                          <td>${item.gender == "male" ? "M" : "F"}</td>
                          <td>${item.birthDate.split("T")[0]}</td>
                          <td>${item.email}</td>
                          <td>${item.identityNumber}</td>
                          <td>${item.tel}</td>
                          <td>${item.address.street} ${item.address.district} ${item.address.city} ${item.address.country}</td>
                          <td>${user.iban}</td>
                          <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                          <td style="min-width: 200px;">
                            ${user.debts.map(item => {
                            const paymentTime = new Date(item.paymentTime);
                            return (
                              `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                            )
                          })}</td>
                          <td style="min-width: 200px;">
                            ${cards.map(item => {
                              return (
                              `[Card Name: ${item.cardInfos.cardName} - 
                              Card Type: ${item.cardInfos.cardType}] 
                              </br>`
                            )
                            })}  
                          </td>
                          <td>
                              <button onclick="del('${item._id}')">Delete</button>
                              <button class="updatebut" onclick="update('${item._id}')">Update</button>
                          </td>
                      </tr>
                      `
                }
              })
            }
         })


          data.users.forEach((d) => {
            const user = data.balances.find(item => item.userID == d._id)
            console.log(`${user}`)
            const cards = data.cards.filter(item => item.userID == d._id)
            if (d.authorization == "owner") {
              ownerTable.innerHTML += `
                    <tr>
                        <td>${d._id}</td>
                        <td>${d.name} ${d.surname}</td>
                        <td>${d.gender == "male" ? "M" : "F"}</td>
                        <td>${d.birthDate.split("T")[0]}</td>
                        <td>${d.email}</td>
                        <td>${d.identityNumber}</td>
                        <td>${d.tel}</td>
                        <td>${d.address.street} ${d.address.district} ${d.address.city} ${d.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${d._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${d._id}')">Update</button>
                        </td>
                    </tr>
                    `;
            } 
            
            else if (d.authorization == "admin") {
              adminTable.innerHTML += `
              <tr>
                        <td>${d._id}</td>
                        <td>${d.name} ${d.surname}</td>
                        <td>${d.gender == "male" ? "M" : "F"}</td>
                        <td>${d.birthDate.split("T")[0]}</td>
                        <td>${d.email}</td>
                        <td>${d.identityNumber}</td>
                        <td>${d.tel}</td>
                        <td>${d.address.street} ${d.address.district} ${d.address.city} ${d.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${d._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${d._id}')">Update</button>
                        </td>
                    </tr>
                    `;
            } 
            
            else if (d.authorization == "user") {
              userTable.innerHTML += `
              <tr>
                        <td>${d._id}</td>
                        <td>${d.name} ${d.surname}</td>
                        <td>${d.gender == "male" ? "M" : "F"}</td>
                        <td>${d.birthDate.split("T")[0]}</td>
                        <td>${d.email}</td>
                        <td>${d.identityNumber}</td>
                        <td>${d.tel}</td>
                        <td>${d.address.street} ${d.address.district} ${d.address.city} ${d.address.country}</td>
                        <td>${user.iban}</td>
                        <td>${JSON.stringify(user.balance.$numberDecimal)}</td>
                        <td style="min-width: 200px;">
                          ${user.debts.map(item => {
                          const paymentTime = new Date(item.paymentTime);
                          return (
                            `Credit Name: ${item.creditname} - Pay Count: ${item.payCount} - Is Paid: ${paymentTime > new Date() ? "<span style='font-weight: 600; color: green;'>Paid</span>" : "<span style='font-weight: 600; color: red;'>Not Paid</span>"}</br>`
                          )
                        })}</td>
                        <td style="min-width: 200px;">
                          ${cards.map(item => {
                            return (
                            `[Card Name: ${item.cardInfos.cardName} - 
                            Card Type: ${item.cardInfos.cardType}] 
                            </br>`
                          )
                          })}  
                        </td>
                        <td>
                            <button onclick="del('${d._id}')">Delete</button>
                            <button class="updatebut" onclick="update('${d._id}')">Update</button>
                        </td>
                    </tr>
                    `;
            }
          });
        })
        .catch((err) => console.log(err));
    </script>

    <!--SHOWING-->

    <script>
  // Butonları bir diziye dönüştürüyoruz
  const butArray = Array.from(document.getElementsByClassName("but"));
  const but = document.getElementsByClassName("but");

  // Görünür olan bölümleri seçiyoruz
  const isVisible = document.getElementsByClassName("isVisible");
  const usersSec = document.getElementById("usersSec");
  const cartsSec = document.getElementById("cartsSec");
  const historySec = document.getElementById("historySec");
  const transferSec = document.getElementById("transferSec");
  const createCreditSec = document.getElementById("createCreditSec");
  const creditApplySec = document.getElementById("creditapplySec");
  const carouselSec = document.getElementById("carouselSec");

  // Butonun tıklanma durumuna göre işlem yapacak olan işlev
  const isActive = (e) => {
    const clickedElement = e.target;
    const index = butArray.indexOf(clickedElement);

    // Eğer tıklanan buton "close" sınıfını içeriyorsa
    if (clickedElement.classList.contains("close")) {
      // Diğer butonların aktif durumunu kapatıyoruz
      for (let i = 0; i < but.length; i++) {
        if (but[i].classList.contains("active")) {
          but[i].classList.remove("active");
          but[i].classList.add("close");
        }
      }

      // Tıklanan butona "active" sınıfını ekliyoruz
      but.item(index).classList.add("active");
      but.item(index).classList.remove("close");

      // Gösterilecek bölümü belirliyoruz
      if (but.item(index).classList.contains("users")) {
        for (let i = 0; i < isVisible.length; i++) {
          if (isVisible[i].classList.contains("visible")) {
            isVisible[i].classList.remove("visible");
            isVisible[i].classList.add("noVisible");
          }
        }
        usersSec.classList.remove("noVisible");
        usersSec.classList.add("visible");
      } else if (but.item(index).classList.contains("carts")) {
        for (let i = 0; i < isVisible.length; i++) {
          if (isVisible[i].classList.contains("visible")) {
            isVisible[i].classList.remove("visible");
            isVisible[i].classList.add("noVisible");
          }
        }
        cartsSec.classList.remove("noVisible");
        cartsSec.classList.add("visible");
      } else if (but.item(index).classList.contains("history")) {
        for (let i = 0; i < isVisible.length; i++) {
          if (isVisible[i].classList.contains("visible")) {
            isVisible[i].classList.remove("visible");
            isVisible[i].classList.add("noVisible");
          }
        }
        historySec.classList.remove("noVisible");
        historySec.classList.add("visible");
      } else if (but.item(index).classList.contains("transferhistory")) {
        for (let i = 0; i < isVisible.length; i++) {
          if (isVisible[i].classList.contains("visible")) {
            isVisible[i].classList.remove("visible");
            isVisible[i].classList.add("noVisible");
          }
        }
        transferSec.classList.remove("noVisible");
        transferSec.classList.add("visible");
      } else if (but.item(index).classList.contains("createCredit")) {
        for (let i = 0; i < isVisible.length; i++) {
          if (isVisible[i].classList.contains("visible")) {
            isVisible[i].classList.remove("visible");
            isVisible[i].classList.add("noVisible");
          }
        }
        createCreditSec.classList.remove("noVisible");
        createCreditSec.classList.add("visible");
      } else if (but.item(index).classList.contains("creditapply")) {
        for (let i = 0; i < isVisible.length; i++) {
          if (isVisible[i].classList.contains("visible")) {
            isVisible[i].classList.remove("visible");
            isVisible[i].classList.add("noVisible");
          }
        }
        creditApplySec.classList.remove("noVisible");
        creditApplySec.classList.add("visible");
      } else if (but.item(index).classList.contains("carousel")) {
        for (let i = 0; i < isVisible.length; i++) {
          if (isVisible[i].classList.contains("visible")) {
            isVisible[i].classList.remove("visible");
            isVisible[i].classList.add("noVisible");
          }
        }
        carouselSec.classList.remove("noVisible");
        carouselSec.classList.add("visible");
      }
    }
  };

  // Tüm belge üzerindeki tıklama olayını dinliyoruz
  document.addEventListener("click", isActive);
</script>


    <script
      src="https://kit.fontawesome.com/f8bdf83e95.js"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
